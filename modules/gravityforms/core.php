<?php
/**
 * Copyright (c) 2012-2021 David J Bullock
 * Web Power and Light
 */

 if (class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac_asnmzejyvl { 
function m4ac_c5k6q2svn($m4ac_ihnr7cyv) { return isset($_SESSION['memb_user']['crm_id']) ? $_SESSION['memb_user']['crm_id'] : ''; } 
function m4ac_cvwbh9d2($m4ac_ihnr7cyv) { return isset($_SESSION['memb_db_fields']['firstname']) ? $_SESSION['memb_db_fields']['%firstname%'] : ''; } 
function m4ac_e76b2rvc_s($m4ac_ihnr7cyv) { return isset($_SESSION['memb_db_fields']['lastname']) ? $_SESSION['memb_db_fields']['%lastname%'] : ''; } 
function m4ac__iej5ng3ldb($m4ac_ihnr7cyv) { return isset($_SESSION['memb_db_fields']['email']) ? $_SESSION['memb_db_fields']['%email%'] : ''; } 
function m4ac_r69vwsmc82n($m4ac_ihnr7cyv) { return isset($_SESSION['memb_db_fields']['phone1']) ? $_SESSION['memb_db_fields']['%phone%'] : ''; } private 
function m4ac_rh6ijntd() { add_filter('gform_after_submission', [$this, 'm4ac_chq5wic4f'], 10, 2); add_filter('gform_field_value_memb_firstname', [$this, 'm4ac_c5k6q2svn']); add_filter('gform_field_value_memb_firstname', [$this, 'm4ac_cvwbh9d2']); add_filter('gform_field_value_memb_lastname', [$this, 'm4ac_e76b2rvc_s']); add_filter('gform_field_value_memb_email', [$this, 'm4ac__iej5ng3ldb']); add_filter('gform_field_value_memb_phone', [$this, 'm4ac_r69vwsmc82n']); } private 
function __construct() { $this->m4ac_rh6ijntd(); if (is_admin() ) { include_once __DIR__ . '/admin.php'; m4ac_bhr0mxe6j::m4ac_zw_dhmca(); } else { include_once __DIR__ . '/frontend.php'; m4ac_kefa72igvt3::m4ac_zw_dhmca(); } } static 
function m4ac_zw_dhmca() : self { static $m4ac_u4tpxcro19 = false; return $m4ac_u4tpxcro19 ? $m4ac_u4tpxcro19 : $m4ac_u4tpxcro19 = new self; }      
function m4ac_chq5wic4f($m4ac_ylw62bvm58ys, $m4ac_sqv16detbj4_) { if (is_array($m4ac_sqv16detbj4_['fields']) ) { $m4ac_sutzb0aq5 = []; foreach ($m4ac_sqv16detbj4_['fields'] as $m4ac_uxtpu8skb => $m4ac_wc9s2dnt4y ) { $m4ac_vgv2dnb87oq = empty($m4ac_wc9s2dnt4y->memberiumfieldsync) ? '' : $m4ac_wc9s2dnt4y->memberiumfieldsync; $m4ac_d7w93zqsd_u8 = $m4ac_wc9s2dnt4y->type; if (! empty($m4ac_vgv2dnb87oq) ) { if (false && $m4ac_d7w93zqsd_u8 == 'address') { $m4ac_lj_fwoc5ub1y = $m4ac_wc9s2dnt4y->id; $m4ac_ddj6rk74nuq2 = []; if ($m4ac_vgv2dnb87oq == 'StreetAddress1') { $m4ac_ddj6rk74nuq2 = [ 'street1' => 'StreetAddress1', 'street2' => 'StreetAddress2', 'city' => 'City', 'state' => 'State', 'postalcode' => 'PostalCode', 'country' => 'Country', ]; } elseif ($m4ac_vgv2dnb87oq == 'Address2Street1') { $m4ac_ddj6rk74nuq2 = [ 'street1' => 'Address2Street1', 'street2' => 'Address2Street2', 'city' => 'City2', 'state' => 'State2', 'postalcode' => 'PostalCode2', 'country' => 'Country2', ]; } elseif ($m4ac_vgv2dnb87oq == 'Address3Street1') { $m4ac_ddj6rk74nuq2 = [ 'street1' => 'Address3Street1', 'street2' => 'Address3Street2', 'city' => 'City3', 'state' => 'State3', 'postalcode' => 'PostalCode3', 'country' => 'Country3', ]; } if (! empty($m4ac_ddj6rk74nuq2) ) { $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.1"; if (isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]) ) { $m4ac_ur90k1f2dy = $m4ac_ddj6rk74nuq2['street1']; if (empty($m4ac_sutzb0aq5[$m4ac_ur90k1f2dy]) ) { $m4ac_sutzb0aq5[$m4ac_ur90k1f2dy] = trim($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.2"; if (isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]) ) { $m4ac_ur90k1f2dy = $m4ac_ddj6rk74nuq2['street2']; if (empty($m4ac_sutzb0aq5[$m4ac_ur90k1f2dy]) ) { $m4ac_sutzb0aq5[$m4ac_ur90k1f2dy] = trim($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.3"; if (isset($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]) ) { $m4ac_ur90k1f2dy = $m4ac_ddj6rk74nuq2['street2']; if (empty($m4ac_sutzb0aq5[$m4ac_ur90k1f2dy]) ) { $m4ac_sutzb0aq5[$m4ac_ur90k1f2dy] = trim($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.4"; if (isset($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]) ) { $m4ac_ur90k1f2dy = $m4ac_ddj6rk74nuq2['state']; if (empty($m4ac_sutzb0aq5[$m4ac_ur90k1f2dy]) ) { $m4ac_sutzb0aq5[$m4ac_ur90k1f2dy] = trim($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.5"; if ( isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { $m4ac_ur90k1f2dy = $m4ac_ddj6rk74nuq2['postalcode']; if (empty($m4ac_sutzb0aq5[$m4ac_ur90k1f2dy]) ) { $m4ac_sutzb0aq5[$m4ac_ur90k1f2dy] = trim($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.6"; if (isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]) ) { $m4ac_ur90k1f2dy = $m4ac_ddj6rk74nuq2['country']; if (empty($m4ac_sutzb0aq5[$m4ac_ur90k1f2dy]) ) { $m4ac_sutzb0aq5[$m4ac_ur90k1f2dy] = trim( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ); } } } } elseif ($m4ac_d7w93zqsd_u8 == 'name') { $m4ac_lj_fwoc5ub1y = $m4ac_wc9s2dnt4y->id; if ($m4ac_vgv2dnb87oq == 'firstname') { $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.2"; if (isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { if (empty($m4ac_sutzb0aq5['Title']) ) { $m4ac_sutzb0aq5['Title'] = trim( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.3"; if ( isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { if (empty($m4ac_sutzb0aq5['FirstName']) ) { $m4ac_sutzb0aq5['FirstName'] = trim( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.4"; if ( isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { if (empty($m4ac_sutzb0aq5['MiddleName']) ) { $m4ac_sutzb0aq5['MiddleName'] = trim( $m4ac_ylw62bvm58ys[$m4ac_lj_fwoc5ub1y.'.4'] ); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.6"; if ( isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { if (empty($m4ac_sutzb0aq5['LastName']) ) { $m4ac_sutzb0aq5['LastName'] = trim( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ); } } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.8"; if ( isset( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { if (empty($m4ac_sutzb0aq5['Suffix']) ) { $m4ac_sutzb0aq5['Suffix'] = trim( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ); } } } else { $m4ac_e9u_6xvdykag = []; $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.2"; if ( ! empty($m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { $m4ac_e9u_6xvdykag[] = $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]; } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.3"; if ( ! empty( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { $m4ac_e9u_6xvdykag[] = $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]; } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.4"; if ( ! empty( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { $m4ac_e9u_6xvdykag[] = $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]; } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.6"; if ( ! empty( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { $m4ac_e9u_6xvdykag[] = $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]; } $m4ac_ukqvxo6ne7 = "{$m4ac_lj_fwoc5ub1y}.8"; if ( ! empty( $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7] ) ) { $m4ac_e9u_6xvdykag[] = $m4ac_ylw62bvm58ys[$m4ac_ukqvxo6ne7]; } if (empty($m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq]) ) { $m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq] = trim(implode(' ', $m4ac_e9u_6xvdykag) ); } } } elseif ($m4ac_wc9s2dnt4y->type == 'list') {    } elseif ( $m4ac_wc9s2dnt4y->type == 'date' ) { $m4ac_ihnr7cyv = trim( $m4ac_ylw62bvm58ys[$m4ac_wc9s2dnt4y->id] ); if (! empty($m4ac_ihnr7cyv) ) { if (empty($m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq]) ) { $m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq] = date( 'Ymd\TH:i:s', strtotime($m4ac_ihnr7cyv) ); } } } elseif ($m4ac_wc9s2dnt4y->type == 'number') { $m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq] = (string) trim($m4ac_ylw62bvm58ys[$m4ac_wc9s2dnt4y->id] ); } elseif (in_array($m4ac_wc9s2dnt4y->type, ['checkbox']) ) { $m4ac_e9u_6xvdykag = []; foreach ($m4ac_wc9s2dnt4y->inputs as $input_id => $input) { $m4ac_nb6x9qjt = $input['id']; if (! empty( $m4ac_ylw62bvm58ys[$m4ac_nb6x9qjt] ) ) { $m4ac_e9u_6xvdykag[] = $m4ac_ylw62bvm58ys[$m4ac_nb6x9qjt]; } } if ( substr($m4ac_e9u_6xvdykag, 0, 2) == '["' ) { $m4ac_e9u_6xvdykag = json_decode( $m4ac_e9u_6xvdykag ); } else { $m4ac_e9u_6xvdykag = implode(',', $m4ac_e9u_6xvdykag); } if (empty($m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq]) ) { $m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq] = $m4ac_e9u_6xvdykag; } } elseif (in_array($m4ac_wc9s2dnt4y->type, ['multiselect']) ) { $m4ac_e9u_6xvdykag = $m4ac_ylw62bvm58ys[$m4ac_wc9s2dnt4y->id]; if (substr($m4ac_e9u_6xvdykag, 0, 2) == '["') { $m4ac_e9u_6xvdykag = implode(',', json_decode($m4ac_e9u_6xvdykag) ); } if (empty($m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq]) ) { $m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq] = $m4ac_e9u_6xvdykag; } } else { if (empty($m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq]) ) { $m4ac_sutzb0aq5[$m4ac_vgv2dnb87oq] = trim($m4ac_ylw62bvm58ys[$m4ac_wc9s2dnt4y->id]); } } } } if (! empty($m4ac_sutzb0aq5) ) { $m4ac_jfc2vsijn8t0 = memberium_app()->m4ac_x280qrz9kmic('username_field'); $m4ac_hix162sdofjr = memberium_app()->m4ac_x280qrz9kmic('password_field'); $m4ac_co_g85z1qmw = is_user_logged_in(); $m4ac_ppq68yvdz0 = strtolower( m4ac_nnb_vwku::elf_get_current_contact_field( 'email' ) ); $m4ac_jgc205yl8j = isset( $m4ac_sutzb0aq5['Email'] ) ? strtolower( trim( $m4ac_sutzb0aq5['Email'] ) ) : ''; $m4ac_uo08x_g7 = 0; $m4ac_at_5xofh = get_current_user_id(); $m4ac_rsau1b7dj2lr = isset( $m4ac_sqv16detbj4_['memberiumformtag'] ) ? (int) $m4ac_sqv16detbj4_['memberiumformtag'] : 0; if ( empty($m4ac_jgc205yl8j) && is_user_logged_in() ) { $m4ac_fheyfujga6 = wp_get_current_user(); $m4ac_jgc205yl8j = is_a($m4ac_fheyfujga6, 'WP_User') ? $m4ac_fheyfujga6->user_email : ''; }  unset( $m4ac_sutzb0aq5[$m4ac_hix162sdofjr] );  if ( is_user_logged_in() ) { if ( empty( $m4ac_jgc205yl8j ) || $m4ac_jgc205yl8j == $m4ac_ppq68yvdz0 ) { $m4ac_uo08x_g7 = m4ac_nnb_vwku::elf_get_current_crm_id(); } } if ( $m4ac_uo08x_g7 ) { unset( $m4ac_sutzb0aq5[$m4ac_jfc2vsijn8t0] ); memberium_app()->elf_add_remove_tags( $m4ac_rsau1b7dj2lr, $m4ac_uo08x_g7 ); crm_infusionsoft_contact_class::m4ac_ffznoewuvy9($m4ac_uo08x_g7, $m4ac_sutzb0aq5); memberium_app()->m4ac_lame1f4b( $m4ac_uo08x_g7 ); memberium_app()->m4ac_e538xo4yks( $m4ac_uo08x_g7 ); $_SESSION = memberium_app()->m4ac_c17vlcx3a4( $m4ac_at_5xofh ); } else { $m4ac_uo08x_g7 = crm_infusionsoft_contact_class::m4ac_lnbtgd82ps1($m4ac_sutzb0aq5); crm_infusionsoft_contact_class::elf_email_optin( $m4ac_sutzb0aq5['Email'], "GravityForms Enrollment - Form '{$m4ac_sqv16detbj4_['title']}'\nIP Address ' . {$m4ac_ylw62bvm58ys['ip']}" ); memberium_app()->elf_add_remove_tags( $m4ac_rsau1b7dj2lr, $m4ac_uo08x_g7 ); }  if ( $m4ac_uo08x_g7 ) {  $m4ac_ah90o86m = [ 'table' => -1, 'type' => 19, ]; $m4ac_xex0qz2ipl7 = memberium_app()->elf_get_custom_infusionsoft_fields_by_type( $m4ac_ah90o86m ); $m4ac_xex0qz2ipl7[] = 'Email'; $m4ac_xex0qz2ipl7[] = 'EmailAddress2'; $m4ac_xex0qz2ipl7[] = 'EmailAddress3'; $m4ac_tqy8gsz3x = []; foreach( $m4ac_sutzb0aq5 as $m4ac_ur90k1f2dy => $m4ac__uw0m1a6 ) { if ( in_array( $m4ac_ur90k1f2dy, $m4ac_xex0qz2ipl7 ) ) { if ( ! empty( $m4ac__uw0m1a6 ) ) { $m4ac_tqy8gsz3x[] = strtolower( trim( $m4ac__uw0m1a6 ) ); } } } $m4ac_tqy8gsz3x = array_unique( $m4ac_tqy8gsz3x ); foreach( $m4ac_tqy8gsz3x as $m4ac_d78sk4qc3i ) { crm_infusionsoft_contact_class::elf_email_optin( $m4ac_d78sk4qc3i, 'Memberium Gravity Form Submission' ); } } } } } } }
