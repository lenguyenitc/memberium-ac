<?php
/**
 * Copyright (c) 2012-2021 David J Bullock
 * Web Power and Light
 */

 if (class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac_bs50znfu { private 
function m4ac_gm6_pd7vl() { return [  '_memberium_lms_autojoin',  '_memberium_lms_autoenroll',  '_memberium_lms_redirect',  '_memberium_lms_assignment_approval_automation', '_memberium_lms_assignment_approval_tag', '_memberium_lms_assignment_upload_automation', '_memberium_lms_assignment_upload_tag',  '_memberium_lms_automation_fail', '_memberium_lms_tag_fail',  '_memberium_lms_achievement', '_memberium_lms_automation', '_memberium_lms_drip_override', '_memberium_lms_tag', ]; } 
function m4ac_ny3wgde4p_j($m4ac_pzocy3nw) { return 'LearnDash'; } 
function m4ac_vf3qbak7($m4ac_id7k9t2q = []) { return array_merge($m4ac_id7k9t2q, [ 'sfwd-courses', 'sfwd-lessons', 'sfwd-topic', 'sfwd-quiz', 'groups', ]); }    
function m4ac_ntcus0hd() { $m4ac_dxtjcmeridh = m4ac_s126v0fexga::m4ac_udme4nbtp(); $m4ac_jnf5st6j4vi = in_array($m4ac_dxtjcmeridh, $this->m4ac_vf3qbak7() ); if ($m4ac_jnf5st6j4vi) { add_meta_box( 'memberium-learndash-actions', "LearnDash for Memberium", [$this, 'm4ac_q9wezqkup4j2'], $m4ac_dxtjcmeridh, 'side' ); } add_action('save_post', [$this, 'm4ac_oct5mu3a_']); } 
function m4ac_q9wezqkup4j2() { global $post; $m4ac__37l6rhivt2 = $post->ID; $m4ac_ah4c_sou = $this->m4ac_gm6_pd7vl(); $m4ac_e3ht7j0fxgiq = memberium_app()->m4ac_iui26zwm5_k($m4ac__37l6rhivt2, $this->m4ac_gm6_pd7vl(), ''); $m4ac_dxtjcmeridh = isset($post->post_type) ? $post->post_type : (isset($_GET['post_type']) ? $_GET['post_type'] : ''); $m4ac_l9lbyvw4xaed = memberium_app()->m4ac_ni3dn9fc('array');  $m4ac_s4zi1mg9wyu = memberium_app()->m4ac_pv1ptjizbd('array');  $m4ac_s2acj3pxehq = get_post_type_object($post->post_type)->labels->singular_name; $m4ac__y9c32zs = in_array($m4ac_dxtjcmeridh, ['sfwd-courses', 'sfwd-lessons', 'sfwd-quiz', 'sfwd-topic']); $m4ac_ehivyjwe6 = in_array($m4ac_dxtjcmeridh, ['sfwd-lessons', 'sfwd-topic']); $m4ac_qvsbpky0 = $m4ac_dxtjcmeridh == 'sfwd-courses'; $m4ac_l7yor2qi1 = $m4ac_dxtjcmeridh == 'groups'; $m4ac_heq649p5l_r1 = $m4ac_dxtjcmeridh == 'sfwd-quiz'; $m4ac_k_c7fa2brmln = $m4ac_dxtjcmeridh == 'sfwd-quiz'; $m4ac_v31pyln7xq = $m4ac_dxtjcmeridh == 'sfwd-courses'; wp_nonce_field(__CLASS__, "memberium_learndash_actions_nonce_{$post->ID}"); if ($m4ac_qvsbpky0) { m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'AutoEnroll Tags<br>', '_memberium_lms_autoenroll[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_autoenroll'], 'tag-selector', [ 'help_id' => 0, 'multiple' => true, 'naked' => true, 'style' => 'width:100%;max-width:100%;', ] ); m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Date-Based Drip Override<br>', '_memberium_lms_drip_override[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_drip_override'], 'tag-selector', [ 'help_id' => 0, 'multiple' => true, 'naked' => true, 'style' => 'width:100%;max-width:100%;', ] );  } if ($m4ac_l7yor2qi1) { m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Group Auto-Join Tags<br>', '_memberium_lms_autojoin[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_autojoin'], 'tag-selector', [ 'help_id' => 0, 'multiple' => true, 'naked' => true, 'style' => 'width:100%;max-width:100%;', ] ); m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Tags to apply to Group Members:<br>', '_memberium_lms_grouptags[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_grouptags'], 'tag-selector', [ 'help_id' => 0, 'multiple' => true, 'naked' => true, 'style' => 'width:100%;max-width:100%;', ] ); } if ($m4ac__y9c32zs) { echo "<p>On completion of this {$m4ac_s2acj3pxehq}, do the following actions:</p>"; m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Run Automation on Completion<br>', '_memberium_lms_automation[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_automation'], 'automationdropdown', [ 'help_id' => 0, 'multiple' => false, 'naked' => true, 'style' => 'width:100%;max-width:100%;', ] ); m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Apply these Tags<br>', '_memberium_lms_tag[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_tag'], 'tag-selector', [ 'help_id' => 0, 'multiple' => true, 'naked' => true, 'style' => 'width:100%;max-width:100%;', ] ); if ($m4ac_k_c7fa2brmln) { echo '<p><br />If the student <strong style="color:red;">fails</strong> this test, execute the following actions:</p>'; m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Run This Automation<br>', '_memberium_lms_automation_fail[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_automation_fail'], 'automationdropdown', [ 'help_id' => 0, 'multiple' => false, 'naked' => true, 'style' => 'width:100%;max-width:100%;', ] ); m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Apply these Tags<br>', '_memberium_lms_tag_fail[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_tag_fail'], 'tag-selector', [ 'help_id' => 0, 'style' => 'width:100%;max-width:100%;', 'multiple' => true, 'naked' => true, ] ); } } if ($m4ac_ehivyjwe6) { echo '<hr />'; m4ac_s126v0fexga::m4ac_r8vk67mcnw2( '<p>On <strong>UPLOAD</strong> of Assignments, do the following actions:</p>', '_memberium_lms_assignment_upload_automation[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_assignment_upload_automation'], 'automationdropdown', [ 'help_id' => 0, 'style' => 'width:100%;max-width:100%;', 'multiple' => false, 'naked' => true, ] ); m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Apply these Tags<br>', '_memberium_lms_assignment_upload_tag[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_assignment_upload_tag'], 'tag-selector', [ 'help_id' => 0, 'style' => 'width:100%;max-width:100%;', 'multiple' => true, 'naked' => true ] ); m4ac_s126v0fexga::m4ac_r8vk67mcnw2( '<p>On <strong>APPROVAL</strong> of Assignments, do the following actions:</p>', '_memberium_lms_assignment_approval_automation[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_assignment_approval_automation'], 'automationdropdown', ['help_id' => 0, 'style' => 'width:100%;max-width:100%;', 'multiple' => false, 'naked' => true] ); m4ac_s126v0fexga::m4ac_r8vk67mcnw2( 'Apply these Tags<br>', '_memberium_lms_assignment_approval_tag[]', $m4ac_e3ht7j0fxgiq['_memberium_lms_assignment_approval_tag'], 'tag-selector', ['help_id' => 0, 'style' => 'width:100%;max-width:100%;', 'multiple' => true, 'naked' => true] ); } if ($m4ac_v31pyln7xq) { echo '<hr />'; echo '<label for="_memberium_lms_redirect">' . _e('Redirect to', 'memberium') . ':</label> '; echo '<input name="_memberium_lms_redirect" style="height: 2em; width:100%; max-width:100%" value="', ($m4ac_e3ht7j0fxgiq['_memberium_lms_redirect'] > '' ? $m4ac_e3ht7j0fxgiq['_memberium_lms_redirect'] : ''), '"><br /><br />'; } m4ac_f5ovcw_1iln::m4ac_zw_dhmca()->m4ac_iy1htpsfj(); } 
function m4ac_oct5mu3a_($m4ac__37l6rhivt2) { if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) { return;  }  if (empty($_POST["memberium_learndash_actions_nonce_{$m4ac__37l6rhivt2}"]) || ! wp_verify_nonce($_POST["memberium_learndash_actions_nonce_{$m4ac__37l6rhivt2}"], __CLASS__) ) { return; } if (! current_user_can('edit_posts', $m4ac__37l6rhivt2) ) { return; } memberium_app()->m4ac_wq7u84xw5v0($m4ac__37l6rhivt2, $this->m4ac_gm6_pd7vl() ); if (! empty($_POST['post_type']) ) { if ($_POST['post_type'] == 'sfwd-courses') { $this->m4ac_akqr1fz2d(); } elseif ($_POST['post_type'] == 'groups') { $this->m4ac_akqr1fz2d(); } } } 
function m4ac_tlh4jm28p($m4ac_clcb0p9mz) { if (! $m4ac_clcb0p9mz) { $m4ac_honbs9x0_yc5 = [ 'learndash_propanel_template', 'ld-report-download', ]; foreach($m4ac_honbs9x0_yc5 as $m4ac_kkjdrw9o) { $m4ac_clcb0p9mz = array_key_exists($m4ac_kkjdrw9o, $_GET); if ($m4ac_clcb0p9mz) { break; } } } return $m4ac_clcb0p9mz; } private 
function m4ac_akqr1fz2d() { $m4ac_nqhkb0w7 = []; $m4ac_ah90o86m = [ 'fields' => 'ids', 'posts_per_page' => -1, 'post_type' => 'sfwd-courses', 'post_status' => 'publish', ]; $m4ac_lel0isn7jtkw = get_posts($m4ac_ah90o86m); foreach($m4ac_lel0isn7jtkw as $m4ac__37l6rhivt2) { $m4ac_nqhkb0w7[$m4ac__37l6rhivt2] = array_filter(explode(',', get_post_meta($m4ac__37l6rhivt2, '_memberium_lms_autoenroll', true) ) ); } $m4ac_nqhkb0w7 = array_filter($m4ac_nqhkb0w7); update_option('memberium/learndash/courses/autoenroll', $m4ac_nqhkb0w7, false); } private 
function m4ac_gf67ky02_3te() { $m4ac_y3ekljoq = []; $m4ac_ah90o86m = [ 'fields' => 'ids', 'posts_per_page' => -1, 'post_type' => 'groups', 'post_status' => 'publish', ]; $m4ac_lel0isn7jtkw = get_posts($m4ac_ah90o86m); foreach($m4ac_lel0isn7jtkw as $m4ac__37l6rhivt2) { $m4ac_y3ekljoq[$m4ac__37l6rhivt2] = array_filter(explode(',', get_post_meta($m4ac__37l6rhivt2, '_memberium_lms_autojoin', true) ) ); } $m4ac_y3ekljoq = array_filter($m4ac_y3ekljoq); update_option('memberium/learndash/groups/autojoin', $m4ac_y3ekljoq, false); }    private 
function m4ac_rh6ijntd() { add_action('admin_init', [$this, 'm4ac_ntcus0hd']); add_filter('memberium/lms/module_post_types', [$this, 'm4ac_vf3qbak7']); add_filter('memberium/lms/name', [$this, 'm4ac_ny3wgde4p_j']); add_filter('memberium/wpadmin/allow', [$this, 'm4ac_tlh4jm28p']); } private 
function __construct() { $this->m4ac_rh6ijntd(); } static 
function m4ac_zw_dhmca() : self { static $m4ac_u4tpxcro19 = false; return $m4ac_u4tpxcro19 ? $m4ac_u4tpxcro19 : $m4ac_u4tpxcro19 = new self; } } }
