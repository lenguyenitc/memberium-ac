<?php
/**
 * Copyright (c) 2012-2021 David J Bullock
 * Web Power and Light
 */

 if (class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac__qk06fim9t3 { private $m4ac_d2s9mi0r4 = false; 
function save_entry($m4ac_ylw62bvm58ys) { global $wpdb; $m4ac_jouqjei9gbc3 = $this->m4ac_d2s9mi0r4->m4ac_nrln4kv906()['entry_table']; $m4ac_rh7rc4v3o = date('Y-m-d H:i:s');  $m4ac_wdl2r3x6jg = [ 'start_time' => $m4ac_rh7rc4v3o, 'contact_id' => 0, 'user_id' => 0, 'object_id' => 0, 'ip_address' => '', 'event_type' => 'none', 'lanuage' => 'en-us', 'method' => 'none', 'request_uri' => '', 'user_agent' => '', 'token' => '', 'notes' => '', ]; $m4ac_ylw62bvm58ys = wp_parse_args($m4ac_ylw62bvm58ys, $m4ac_wdl2r3x6jg); $m4ac_lsxa90fgqk = [ 'end_time' => $m4ac_rh7rc4v3o, ]; $m4ac_ofd6sp_0 = [ 'token' => $m4ac_ylw62bvm58ys['token'], 'end_time' => '0000-00-00 00:00:00', ]; $wpdb->update($m4ac_jouqjei9gbc3, $m4ac_lsxa90fgqk, $m4ac_ofd6sp_0);  $m4ac_lsxa90fgqk = [ 'contact_id' => (int) $m4ac_ylw62bvm58ys['contact_id'], 'user_id' => (int) $m4ac_ylw62bvm58ys['user_id'], 'object_id' => (int) $m4ac_ylw62bvm58ys['object_id'], 'ip_address' => substr($m4ac_ylw62bvm58ys['ip_address'], 0, 50), 'language' => substr($m4ac_ylw62bvm58ys['language'], 0, 12), 'event_type' => substr($m4ac_ylw62bvm58ys['event_type'], 0, 24), 'method' => substr($m4ac_ylw62bvm58ys['method'], 0, 12), 'request_uri' => substr($m4ac_ylw62bvm58ys['request_uri'], 0, 128), 'user_agent' => substr($m4ac_ylw62bvm58ys['user_agent'], 0, 96), 'token' => substr($m4ac_ylw62bvm58ys['token'], 0, 64), ]; $m4ac_o2lhyvkaf_ = [ '%d', '%d', '%d', '%s', '%s', '%s', '%s', '%s', '%s', '%s', ]; $m4ac_fic2e07vfkz = $wpdb->insert($m4ac_jouqjei9gbc3, $m4ac_lsxa90fgqk, $m4ac_o2lhyvkaf_); } 
function m4ac__01ysz2l() { global $post; if (wp_doing_ajax() ) { return; } $m4ac_at_5xofh = get_current_user_id(); $m4ac_uo08x_g7 = isset($_SESSION['memb_user']['crm_id']) ? $_SESSION['memb_user']['crm_id'] : memberium_app()->m4ac_pm63av15g($m4ac_at_5xofh); if ($m4ac_at_5xofh && $m4ac_uo08x_g7 && ! user_can($m4ac_at_5xofh, 'edit_others_posts') ) { $m4ac_ylw62bvm58ys['contact_id'] = $m4ac_uo08x_g7; $m4ac_ylw62bvm58ys['event_type'] = 'pageload'; $m4ac_ylw62bvm58ys['ip_address'] = m4ac_p58mfx3cua::m4ac_teq1zlwih6(); $m4ac_ylw62bvm58ys['method'] = isset($_SERVER['REQUEST_METHOD']) ? $_SERVER['REQUEST_METHOD'] : ''; $m4ac_ylw62bvm58ys['object_id'] = isset($post->ID) ? $post->ID : 0; $m4ac_ylw62bvm58ys['language'] = isset($_SERVER['HTTP_ACCEPT_LANGUAGE']) ? $_SERVER['HTTP_ACCEPT_LANGUAGE'] : '-'; $m4ac_ylw62bvm58ys['request_uri'] = isset($_SERVER['REQUEST_URI']) ? $_SERVER['REQUEST_URI'] : ''; $m4ac_ylw62bvm58ys['timestamp'] = time(); $m4ac_ylw62bvm58ys['token'] = wp_parse_auth_cookie('', 'logged_in')['token']; $m4ac_ylw62bvm58ys['user_agent'] = isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : ''; $m4ac_ylw62bvm58ys['user_id'] = $m4ac_at_5xofh; $this->save_entry($m4ac_ylw62bvm58ys); } } 
function m4ac_rh6ijntd() { add_action('wp_head', [$this, 'm4ac__01ysz2l'], 10); } 
function __construct($m4ac_d2s9mi0r4) { $this->m4ac_d2s9mi0r4 = $m4ac_d2s9mi0r4; $this->m4ac_rh6ijntd(); } } }
