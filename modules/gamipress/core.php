<?php
/**
 * Copyright (c) 2012-2021 David J Bullock
 * Web Power and Light
 */

 if (class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac_ppbzvcq5k0ie { 
function m4ac_if_gucaht0x($m4ac_at_5xofh = 0, $m4ac_yznhxig5vw8 = 0) { $m4ac_at_5xofh = $m4ac_at_5xofh > 0 ? $m4ac_at_5xofh : get_current_user_id(); $m4ac_uo08x_g7 = (int) memberium_app()->m4ac_pm63av15g($m4ac_at_5xofh); if (! $m4ac_uo08x_g7 || ! $m4ac_at_5xofh) { return; } $m4ac_e3ht7j0fxgiq = []; $m4ac_u9uhl_ci87 = [ '_memberium_tag', '_memberium_automation', ]; foreach($m4ac_u9uhl_ci87 as $m4ac_ur90k1f2dy) { $m4ac_e3ht7j0fxgiq[$m4ac_ur90k1f2dy] = get_post_meta($m4ac_yznhxig5vw8, $m4ac_ur90k1f2dy, true); } if ($m4ac_e3ht7j0fxgiq['_memberium_tag']) { memberium_app()->m4ac_ocsjt69hrb($m4ac_e3ht7j0fxgiq['_memberium_tag'], $m4ac_uo08x_g7); } if ($m4ac_e3ht7j0fxgiq['_memberium_automation']) { memberium_app()->m4ac_lmhdiugb6cs($m4ac_e3ht7j0fxgiq['_memberium_automation'], $m4ac_uo08x_g7); } } 
function m4ac_nfdpuh235y8z($m4ac_at_5xofh, $m4ac_hx5ta0n2, $m4ac_w35gvu07ne, $m4ac_q3tloj5r4y, $m4ac_yznhxig5vw8, $m4ac_jhkqcb74, $m4ac_lc6um3f27egp, $m4ac_fhljeqi8c3rz) { $m4ac_at_5xofh = $m4ac_at_5xofh > 0 ? $m4ac_at_5xofh : get_current_user_id(); if ($m4ac_at_5xofh) { $m4ac_uo08x_g7 = (int) memberium_app()->m4ac_pm63av15g($m4ac_at_5xofh); if ($m4ac_uo08x_g7) {    } } } 
function m4ac_lf0hdib2r($m4ac_at_5xofh, $m4ac_mfuovp3cjkm, $m4ac_p8cvfhm21iu, $m4ac_q3tloj5r4y, $m4ac_yznhxig5vw8) { $m4ac_at_5xofh = $m4ac_at_5xofh > 0 ? $m4ac_at_5xofh : get_current_user_id(); $m4ac_uo08x_g7 = (int) memberium_app()->m4ac_pm63av15g($m4ac_at_5xofh); if (! $m4ac_uo08x_g7 || ! $m4ac_at_5xofh) { return; } if (is_object($m4ac_mfuovp3cjkm) ) { $m4ac__37l6rhivt2 = $m4ac_mfuovp3cjkm->ID; } $m4ac_e3ht7j0fxgiq = []; $m4ac_u9uhl_ci87 = [ '_memberium_tag', '_memberium_automation', ]; foreach($m4ac_u9uhl_ci87 as $m4ac_ur90k1f2dy) { $m4ac_e3ht7j0fxgiq[$m4ac_ur90k1f2dy] = get_post_meta($m4ac__37l6rhivt2, $m4ac_ur90k1f2dy, true); } if ($m4ac_e3ht7j0fxgiq['_memberium_tag']) { memberium_app()->m4ac_ocsjt69hrb($m4ac_e3ht7j0fxgiq['_memberium_tag'], $m4ac_uo08x_g7); } if ($m4ac_e3ht7j0fxgiq['_memberium_automation']) { memberium_app()->m4ac_lmhdiugb6cs($m4ac_e3ht7j0fxgiq['_memberium_automation'], $m4ac_uo08x_g7); } } 
function m4ac_lghvxt0q4z($m4ac_at_5xofh, $m4ac__crsbi5yuze) { if (! function_exists('gamipress_award_achievement_to_user') ) { return; } if (empty($m4ac__crsbi5yuze['memb_db_fields']['tag_ids']) ) { return; } $m4ac_at_5xofh = $m4ac_at_5xofh > 0 ? $m4ac_at_5xofh : get_current_user_id(); if (empty($m4ac_at_5xofh) ) { return; } $m4ac_j0e14tousp_ = array_filter(explode(',', $m4ac__crsbi5yuze['memb_db_fields']['tag_ids']) ); $m4ac_tvwmj3nezd7 = get_option('memberium/gamipress/assign_by_tag', [] ); $m4ac_o_wlyfigm97c = $this->m4ac_jfdzmch3_7j($m4ac_at_5xofh); foreach($m4ac_tvwmj3nezd7 as $m4ac_yznhxig5vw8 => $m4ac_rsau1b7dj2lr) { if (! empty($m4ac_rsau1b7dj2lr) ) { if (! in_array($m4ac_yznhxig5vw8, $m4ac_o_wlyfigm97c) ) { if (in_array($m4ac_rsau1b7dj2lr, $m4ac_j0e14tousp_) ) { $m4ac_o_wlyfigm97c[] = $m4ac_yznhxig5vw8; $m4ac_qr2kxcmulte = $this->m4ac_vo9h4csm($m4ac_yznhxig5vw8); gamipress_award_achievement_to_user($m4ac_yznhxig5vw8, $m4ac_at_5xofh); } } } } } 
function m4ac_jfdzmch3_7j($m4ac_at_5xofh = 0) { $m4ac_ah90o86m = [ 'user_id' => $m4ac_at_5xofh, ]; $m4ac_o_wlyfigm97c = gamipress_get_user_achievements($m4ac_ah90o86m); $m4ac_m5iu_o1l9y63 = array_map(function($m4ac__2sbtcpi0jey){ return $m4ac__2sbtcpi0jey->ID; }, $m4ac_o_wlyfigm97c); return $m4ac_m5iu_o1l9y63; } 
function m4ac_g869u1ypmz7($m4ac_at_5xofh, $m4ac__37l6rhivt2) { if (function_exists('badgeos_award_achievement_to_user') ) { $m4ac_wnx_rwg4dya = get_post_meta($m4ac__37l6rhivt2, '_memberium_lms_achievement', true); if ($m4ac_wnx_rwg4dya) { badgeos_award_achievement_to_user($m4ac_wnx_rwg4dya, $m4ac_at_5xofh); } } } 
function m4ac_rh6ijntd() { add_action('gamipress_award_achievement', [$this, 'm4ac_if_gucaht0x'], 10, 2); add_action('gamipress_update_user_rank', [$this, 'm4ac_lf0hdib2r'], 10, 5); add_action('gamipress_update_user_points', [$this, 'm4ac_nfdpuh235y8z'], 10, 8); add_action('memberium/lms/completion', [$this, 'm4ac_g869u1ypmz7'], 10, 2); add_action('memberium/session/updated', [$this, 'm4ac_lghvxt0q4z'], 10, 2); } 
function m4ac_vo9h4csm($m4ac__37l6rhivt2) { $m4ac_dxtjcmeridh = get_post_type($m4ac__37l6rhivt2); $m4ac_ss6bwxopg8 = ''; if (in_array($m4ac_dxtjcmeridh, gamipress_get_achievement_types_slugs() ) ) { $m4ac_ss6bwxopg8 = 'achievement'; } elseif (in_array($m4ac_dxtjcmeridh, gamipress_get_rank_types_slugs() ) ) { $m4ac_ss6bwxopg8 = 'rank'; } elseif (in_array($m4ac_dxtjcmeridh, gamipress_get_points_types_slugs() ) ) { $m4ac_ss6bwxopg8 = 'points'; } return $m4ac_ss6bwxopg8; } private 
function __construct() { memberium_app()->m4ac_chxl7ms_o9c('m4acgamipress', 'GamiPress for Memberium for ActiveCampaign'); $this->m4ac_rh6ijntd(); if (is_admin() ) { m4ac_nukiz24xg::m4ac_zw_dhmca(); } else { m4ac_h2bfyivjs::m4ac_zw_dhmca(); } } static 
function m4ac_zw_dhmca() : self { static $m4ac_u4tpxcro19 = false; return $m4ac_u4tpxcro19 ? $m4ac_u4tpxcro19 : $m4ac_u4tpxcro19 = new self; }  } }
