<?php
/**
 * Copyright (c) 2020 David J Bullock
 * Web Power and Light
 */

 if (! defined('ABSPATH') ) { die(); } if (class_exists('m4ac_fxpbyk36nrs')) { final 
class m4ac_deyxmcw_ { 
function m4ac_pmkp5wqe9hbu( $m4ac_maz5nvkp ){  $m4ac_q8y5rflc = empty($m4ac_maz5nvkp['child_uid']) ? false : (int) $m4ac_maz5nvkp['child_uid']; $m4ac_r7l9ptndubs1 = empty($m4ac_maz5nvkp['parent_uid']) ? false : (int) $m4ac_maz5nvkp['parent_uid']; if( empty($m4ac_q8y5rflc) || empty($m4ac_r7l9ptndubs1) ){ return new WP_Error( 401, __('Error removing child account.', 'memberium') ); } else{ m4ac_fxpbyk36nrs::m4ac_zw_dhmca()->m4ac_ysk0p4lw( $m4ac_q8y5rflc, $m4ac_r7l9ptndubs1 ); return _x( 'Child Account removed.', 'memb_list_children', 'memberium' ); } } 
function m4ac_qok768r1m($m4ac_maz5nvkp = [], $m4ac_uo08x_g7 = 0, $m4ac_fheyfujga6 = null) { $m4ac_kp6zrjntmf78 = isset($m4ac_maz5nvkp['memberium/child_code']) ? $m4ac_maz5nvkp['memberium/child_code'] : ''; if (! empty($m4ac_kp6zrjntmf78) ) { $m4ac_w_anh6b8u = m4ac_fxpbyk36nrs::m4ac_zw_dhmca(); $m4ac_q8y5rflc = is_a($m4ac_fheyfujga6, 'WP_User') ? $m4ac_fheyfujga6->ID : 0; $m4ac_r7l9ptndubs1 = $m4ac_w_anh6b8u->m4ac_rh1jcw4u6f3($m4ac_kp6zrjntmf78); if ($m4ac_r7l9ptndubs1) { $m4ac_fic2e07vfkz = $m4ac_w_anh6b8u->m4ac_n9246tnvsclq($m4ac_q8y5rflc, $m4ac_r7l9ptndubs1); if( $m4ac_fic2e07vfkz ){ do_action('m4ac/groupaccounts/child/added', $m4ac_q8y5rflc, $m4ac_r7l9ptndubs1); } } } } 
function m4ac_kj4dzseau3( $m4ac_maz5nvkp ){ if ( ! memberium_app()->m4ac_bh4tj53v6z8k( $m4ac_maz5nvkp['signature'], $m4ac_maz5nvkp['params'] ) ) { wp_die( 'Security Check Failed - Signature Validation Error'); exit; } if (memberium_app()->m4ac_k6b8c0f7g5() ) { return; } $m4ac_g430cin8 = 'memberium'; $m4ac_w5p1_r6f2xw = wp_get_current_user(); $m4ac_r7l9ptndubs1 = !empty($m4ac_w5p1_r6f2xw) && !empty($m4ac_w5p1_r6f2xw->ID) ? $m4ac_w5p1_r6f2xw->ID : false; if( ! $m4ac_r7l9ptndubs1 ){ return; } $m4ac_w_anh6b8u = m4ac_fxpbyk36nrs::m4ac_zw_dhmca(); $m4ac_te6rvtapbjw = memberium_app()->m4ac_x280qrz9kmic('groupaccounts/tag/parent'); if ( ! memberium_app()->m4ac_t5ws0_v68($m4ac_te6rvtapbjw) ) { return; } $m4ac_bxvpge5qkdo9 = unserialize(base64_decode( $m4ac_maz5nvkp['params']) ); $m4ac_qiog7y60f = (int) $m4ac_bxvpge5qkdo9['contact_id']; $m4ac_d80mjpndab = 0; $m4ac_bf9ovj7teud = 0; $m4ac_q8y5rflc = 0; $m4ac_lngipzehx8 = explode(',', $m4ac_bxvpge5qkdo9['allowed_automations']); $m4ac_hnza0w5f = isset($m4ac_maz5nvkp['automation'] ) ? (int) $m4ac_maz5nvkp['automation'] : 0; $m4ac_hnza0w5f = ! in_array($m4ac_hnza0w5f, $m4ac_lngipzehx8) ? 0 : $m4ac_hnza0w5f; $m4ac_axqw5sklt2u = empty($m4ac_maz5nvkp['email']) ? false : strtolower( trim($m4ac_maz5nvkp['email']) ); $m4ac_x5i3zfd4s2co = "<p style=\"color:%s;font-weight:bold;\">%s</p>";  if ( ! $m4ac_axqw5sklt2u ) { $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( 'Email is Required', 'memb_enroll_child', $m4ac_g430cin8 ) ); return; } if ( empty($m4ac_maz5nvkp['firstname']) ) { $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( 'First Name is Required', 'memb_enroll_child', $m4ac_g430cin8 ) ); return; }  if (strtolower( trim($m4ac_w5p1_r6f2xw->user_email) ) === $m4ac_axqw5sklt2u) { $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( "You can't add yourself.", 'memb_enroll_child', $m4ac_g430cin8 ) ); return; }  $m4ac_n30q2f679 = get_user_by('email', $m4ac_axqw5sklt2u); if (is_a($m4ac_n30q2f679, 'WP_User') ) { if (! $m4ac_w_anh6b8u->m4ac_l7ocib12d($m4ac_n30q2f679->ID) ) { $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( "That member is not eligible to be adopted.", 'memb_enroll_child', $m4ac_g430cin8 ) ); return; }  if( user_can($m4ac_n30q2f679, 'edit_others_posts') ){ $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( "You cannot add site staff members.", 'memb_enroll_child', $m4ac_g430cin8 ) ); return; } else{  $m4ac_q8y5rflc = $m4ac_n30q2f679->ID; $m4ac_d80mjpndab = $m4ac_w_anh6b8u->m4ac_oaegc05s8nw6($m4ac_q8y5rflc); if( $m4ac_d80mjpndab > 0 && $m4ac_d80mjpndab !== $m4ac_r7l9ptndubs1 ){ $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x("That account is already assigned to a user.", 'memb_enroll_child', $m4ac_g430cin8) ); return; } else{  $m4ac_bf9ovj7teud = memberium_app()->m4ac_pm63av15g($m4ac_q8y5rflc); } } }  $m4ac_qsvd0m6oq = []; $m4ac_ech62wzelm8d = memberium_app()->m4ac_n_1ak7e32(); foreach($m4ac_ech62wzelm8d as $m4ac_ukqvxo6ne7 => $m4ac_ihnr7cyv) { if (isset($m4ac_maz5nvkp[$m4ac_ihnr7cyv]) ) { $m4ac_qsvd0m6oq[$m4ac_ihnr7cyv] = $m4ac_maz5nvkp[$m4ac_ihnr7cyv];  } }  $m4ac_f45rcm9pdo = ! empty($m4ac_bf9ovj7teud) ? _x( 'Child Account added.', 'memb_enroll_child', $m4ac_g430cin8 ) : _x( 'Child Account assigned.', 'memb_enroll_child', $m4ac_g430cin8 );  $m4ac_bf9ovj7teud = memberium_app()->m4ac_uj7435zxcb2(['fields' => $m4ac_qsvd0m6oq]); if( empty($m4ac_bf9ovj7teud) ){ $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( "There has been an error creating the account", 'memb_enroll_child', $m4ac_g430cin8 ) ); return; }  $m4ac_q8y5rflc = memberium_app()->m4ac_e538xo4yks($m4ac_bf9ovj7teud); if( empty( $m4ac_q8y5rflc ) ){ $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( "There has been an error creating the user", 'memb_enroll_child', $m4ac_g430cin8 ) ); return; }  if( $m4ac_d80mjpndab !== $m4ac_r7l9ptndubs1 ){ if( ! $m4ac_w_anh6b8u->m4ac_n9246tnvsclq($m4ac_q8y5rflc, $m4ac_r7l9ptndubs1) ){ $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'red', _x( "There has been an error assigning the account", 'memb_enroll_child', $m4ac_g430cin8 ) ); return; } }   $m4ac_bwbipq549 = memberium_app()->m4ac_x280qrz9kmic('groupaccounts/child/added', 0); $m4ac_lxswye1b = memberium_app()->m4ac_x280qrz9kmic('groupaccounts/parent/added', 0); $_SESSION['flash']['enroll_child_message'] = sprintf( $m4ac_x5i3zfd4s2co, 'green', $m4ac_f45rcm9pdo ); memberium_app()->m4ac_lmhdiugb6cs($m4ac_bwbipq549, $m4ac_bf9ovj7teud); memberium_app()->m4ac_lmhdiugb6cs($m4ac_lxswye1b, $m4ac_qiog7y60f); do_action('m4ac/groupaccounts/child/added', $m4ac_q8y5rflc, $m4ac_r7l9ptndubs1); return; } public static 
function m4ac_zw_dhmca() : self { static $m4ac_u4tpxcro19 = false; return $m4ac_u4tpxcro19 ? $m4ac_u4tpxcro19 : $m4ac_u4tpxcro19 = new self; } } }
