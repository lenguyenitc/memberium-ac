var thumb='';var default_product_title='';var default_product_button='';var $thumb='';var pathFile='';jQuery(document).ready(function(){thumb=jQuery('.default-product').attr('src');$thumb=jQuery('<img src="'+thumb+'"/>');default_product_title=jQuery('.default_product_title').attr('data-title');default_product_button=jQuery('.default_product_button').html();pathFile=jQuery('.default_product_song').attr('data-file');jQuery('#title .thumb').html('').append($thumb);jQuery('#title .track').html('').append(default_product_title);jQuery('#defaultbutton').html('').append(default_product_button);});var elms=['track','timer','duration','playBtn','pauseBtn','prevBtn','nextBtn','playlistBtn','volumeBtn','progress','bar','wave','loading','playlist','list','volume','barEmpty','barFull','sliderBtn'];elms.forEach(function(elm){window[elm]=document.getElementById(elm);});var currentHowl=Object;var Player=function(playlist){this.playlist=playlist;this.index=0;this.howl=Object;track.innerHTML=playlist[0].title;};Player.prototype={play:function(index){var self=this;var sound;index=typeof index==='number'?index:self.index;var data=self.playlist[index];console.log(list);if(data.howl){sound=data.howl;}else{sound=data.howl=self.playlist[index].howl=new Howl({src:[data.file],html5:true,onplay:function(){duration.innerHTML=self.formatTime(Math.round(sound.duration()));requestAnimationFrame(self.step.bind(self));wave.container.style.display='block';pauseBtn.style.display='block';},onload:function(){wave.container.style.display='block';loading.style.display='none';},onend:function(){wave.container.style.display='none';bar.style.display='block';self.skip('right');},onpause:function(){wave.container.style.display='none';bar.style.display='block';},onstop:function(){wave.container.style.display='none';bar.style.display='block';}});}sound.play();track.innerHTML=data.title;if(sound.state()==='loaded'){playBtn.style.display='none';pauseBtn.style.display='block';}else{loading.style.display='block';playBtn.style.display='none';pauseBtn.style.display='none';}self.index=index;currentHowl=self.howl=sound;},pause:function(){var self=this;var sound=currentHowl;sound.pause();playBtn.style.display='block';pauseBtn.style.display='none';},stop:function(){var self=this;var sound=currentHowl;sound.stop();playBtn.style.display='block';pauseBtn.style.display='none';},skip:function(direction){var self=this;var index=0;if(direction==='prev'){index=self.index-1;if(index<0){index=self.playlist.length-1;}}else{index=self.index+1;if(index>=self.playlist.length){index=0;}}self.skipTo(index);},skipTo:function(index){var self=this;if(self.playlist[self.index].howl){self.playlist[self.index].howl.stop();}progress.style.width='0%';self.play(index);},volume:function(val){var self=this;var sound=currentHowl;sound.volume(val);},seek:function(per){var self=this;var sound=currentHowl;if(sound.playing()){sound.seek(sound.duration()*per);}},step:function(){var self=this;var sound=currentHowl;var seek=sound.seek()||0;timer.innerHTML=self.formatTime(Math.round(seek));progress.style.width=(((seek/sound.duration())*100)||0)+'%';if(sound.playing()){requestAnimationFrame(self.step.bind(self));}},togglePlaylist:function(){var self=this;var display=(playlist.style.display==='block')?'none':'block';setTimeout(function(){playlist.style.display=display;},(display==='block')?0:500);playlist.className=(display==='block')?'fadein':'fadeout';},toggleVolume:function(){if(!$('#uivolume').is(':visible')){$('#uivolume').show();}else{$('#uivolume').hide();}$('#uivolume').on('mouseleave',function(){$('#uivolume').hide();});},formatTime:function(secs){var minutes=Math.floor(secs/60)||0;var seconds=(secs-minutes*60)||0;return minutes+':'+(seconds<10?'0':'')+seconds;}};var player=new Player([{title:default_product_title,file:'rave_digger',howl:null},{title:'80s vibe',file:'80s_vibe',howl:null}]);playBtn.addEventListener('click',function(){player.play();});pauseBtn.addEventListener('click',function(){player.pause();$('.js-sound.pause').trigger('click');});prevBtn.addEventListener('click',function(){player.skip('prev');});nextBtn.addEventListener('click',function(){player.skip('next');});waveform.addEventListener('click',function(event){player.seek(event.clientX/window.innerWidth);});volumeBtn.addEventListener('click',function(){player.toggleVolume();});var value=parseInt($('#uivolume span').text(),10);$('#uivolume span').empty().slider({value:value,range:"min",animate:true,orientation:"vertical",slide:function(event,ui){player.volume(ui.value/100);}});var wave=new SiriWave({container:waveform,width:window.innerWidth,height:window.innerHeight*0.3,cover:true,speed:0.03,amplitude:0.7,frequency:2});wave.start();var resize=function(){var height=window.innerHeight*0.3;var width=window.innerWidth;wave.height=height;wave.height_2=height/2;wave.MAX=wave.height_2-4;wave.width=width;wave.width_2=width/2;wave.width_4=width/4;wave.canvas.height=height;wave.canvas.width=width;};window.addEventListener('resize',resize);resize();