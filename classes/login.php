<?php
/**
 * Copyright (c) 2012-2021 David J Bullock
 * Web Power and Light
 */

 if (class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac_d4yt1zjli { static private 
function m4ac_ecs9z_v281i() { return crc32(m4ac_p58mfx3cua::m4ac_teq1zlwih6() . 'Hail to the King, Baby'); } static 
function m4ac_nqyriec10() { return "<input name='bruteforcecheck' type='hidden' value='" . self::m4ac_ecs9z_v281i() ."' />"; } static 
function m4ac_s069e_d1qkl($m4ac_c4qc56391fd = false, $m4ac_ah90o86m = []) { $m4ac_pa2k7635qor = self::m4ac_nqyriec10(); if (current_action() == 'login_form') { echo $m4ac_pa2k7635qor; } return $m4ac_c4qc56391fd . $m4ac_pa2k7635qor; } static 
function m4ac_cgc0zbur5(&$m4ac_nmf72t01) { if (empty($m4ac_nmf72t01) ) { return $m4ac_nmf72t01; } $m4ac_fheyfujga6 = get_user_by('email', $m4ac_nmf72t01); if (! empty($m4ac_fheyfujga6->user_login) ) { $m4ac_nmf72t01 = $m4ac_fheyfujga6->user_login; } $_POST['log'] = $m4ac_nmf72t01; return $m4ac_nmf72t01; }  static 
function m4ac_f8glwn2bd($m4ac_nmf72t01, $m4ac_rex7bvpq) { global $wpdb; if (empty($m4ac_nmf72t01) ) { return false; }  $m4ac_fheyfujga6 = get_user_by('email', $m4ac_nmf72t01); if (! $m4ac_fheyfujga6) { $m4ac_fheyfujga6 = get_user_by('login', $m4ac_nmf72t01); if (! $m4ac_fheyfujga6) { return false; } }  if ($m4ac_rex7bvpq !== false) { if (! wp_check_password($m4ac_rex7bvpq, $m4ac_fheyfujga6->data->user_pass, $m4ac_fheyfujga6->ID) ) { return false; } }  if (user_can($m4ac_fheyfujga6, 'manage_options')) { return true; }  if (! m4ac_tl5skz6cfptr::m4ac_e28auldn() ) { return false; } $m4ac_uyekwg_t = ! memberium_app()->m4ac_x280qrz9kmic('disable_login_sync'); if ($m4ac_uyekwg_t) { memberium_app()->m4ac_k48infdavhmr($m4ac_fheyfujga6->user_login); } $m4ac_uo08x_g7 = memberium_app()->m4ac_zbf2o6mu($m4ac_fheyfujga6->user_login); if ($m4ac_uyekwg_t) { memberium_app()->m4ac_e538xo4yks($m4ac_uo08x_g7); } if (! $m4ac_uo08x_g7) { $m4ac_fheyfujga6 = new WP_Error('authentication_failed', __('<strong>ERROR</strong>: Unknown Account.', 'memberium') ); return null; } $m4ac_qsvd0m6oq = memberium_app()->m4ac_zrj6g8l4ap9i($m4ac_uo08x_g7); $m4ac_j0e14tousp_ = isset($m4ac_qsvd0m6oq['tag_ids']) ? explode(',', $m4ac_qsvd0m6oq['tag_ids']) : []; $m4ac_fwtp4v0kf = memberium_app()->m4ac_x280qrz9kmic('site_ban_tag');  if ($m4ac_fwtp4v0kf && in_array($m4ac_fwtp4v0kf, $m4ac_j0e14tousp_) ) { wp_set_current_user(0); session_write_close(); $m4ac_fheyfujga6 = new WP_Error('authentication_failed', __('Your access is currently suspended. Please contact customer support for further details.', 'memberium') ); return $m4ac_fheyfujga6; } }  static 
function m4ac_b5vcku_24jr($m4ac_yyzs0red2534, $m4ac_fheyfujga6 = null) {  } private static 
function m4ac_ol1axvj2ik($m4ac_fheyfujga6) { if (memberium_app()->doing_autologin || memberium_app()->passwordless_login) { return; } $m4ac_hix162sdofjr = strtolower( memberium_app()->m4ac_x280qrz9kmic('password_field') ); if (empty($m4ac_hix162sdofjr)) { return; } if (! empty($_SESSION['memb_db_fields'][$m4ac_hix162sdofjr]) ) { memberium_app()->m4ac_se9c7jni2qhf($m4ac_hix162sdofjr, ''); } }  static 
function m4ac_l6w_auhxd1g($m4ac_yyzs0red2534, $m4ac_fheyfujga6 = null) { if (is_a($m4ac_fheyfujga6, 'WP_User')) { global $pagenow; if ($m4ac_fheyfujga6 == null) { $m4ac_fheyfujga6 = wp_get_current_user(); }  if (empty($_SESSION['memb_user']) ) { $_SESSION = memberium_app()->m4ac_c17vlcx3a4($m4ac_fheyfujga6->ID); } self::m4ac_y4gxn6rwm($m4ac_fheyfujga6); $m4ac_b28d_brj9 = user_can($m4ac_fheyfujga6, 'manage_options');  if ($m4ac_b28d_brj9) { return; } memberium_app()->m4ac_xur62hzbo(); memberium_app()->m4ac_b_ikylpvfs($m4ac_fheyfujga6); self::m4ac__by4t7owav3($m4ac_fheyfujga6); self::m4ac_ol1axvj2ik($m4ac_fheyfujga6); self::m4ac__bqgnau_0i($m4ac_fheyfujga6); self::m4ac_ignbul1qae($m4ac_fheyfujga6); $_POST['redirect_to'] = empty($_POST['redirect_to']) ? '' : $_POST['redirect_to'];  if (memberium_app()->m4ac_x280qrz9kmic('allow_wpadmin') == 0) { if (stripos($_POST['redirect_to'], '/wp-admin') !== false) { $_POST['redirect_to'] = ''; } }  if (! empty($_SESSION['memb_user']['crm_id']) ) { $m4ac_nokx60vpizu = memberium_app()->m4ac_x280qrz9kmic('login_automation'); if (! empty($m4ac_nokx60vpizu) ) { memberium_app()->m4ac_lmhdiugb6cs($m4ac_nokx60vpizu, $_SESSION['memb_user']['crm_id']); } } } } private static 
function m4ac__by4t7owav3($m4ac_fheyfujga6) { $m4ac_at_5xofh = $m4ac_fheyfujga6->ID; $m4ac_z4tujzo5_0cn = (int) get_user_meta($m4ac_at_5xofh, 'login_count', true) + 1; $m4ac_fic2e07vfkz = update_user_meta($m4ac_at_5xofh, 'login_count', $m4ac_z4tujzo5_0cn); $m4ac_fic2e07vfkz = update_user_meta($m4ac_at_5xofh, 'login_ip_address', m4ac_p58mfx3cua::m4ac_teq1zlwih6() ); $m4ac_fic2e07vfkz = update_user_meta($m4ac_at_5xofh, 'last_login_time', time() ); return true; } private static 
function m4ac_ignbul1qae($m4ac_fheyfujga6) { $m4ac_u9uhl_ci87 = []; $m4ac_a9uw2ycovqj = memberium_app()->m4ac_x280qrz9kmic('last_login_field'); if (! empty($m4ac_a9uw2ycovqj) ) { $m4ac_dkyr51hqv67 = date_default_timezone_get(); date_default_timezone_set('America/New_York'); $m4ac_k5dbw829nao = date('Y-m-d\TH:i:s'); date_default_timezone_set($m4ac_dkyr51hqv67); $m4ac_u9uhl_ci87[$m4ac_a9uw2ycovqj] = $m4ac_k5dbw829nao; } } static 
function m4ac_si5rbm46wgh3($m4ac_fheyfujga6, string $m4ac_nmf72t01 = '', string $m4ac_rex7bvpq = '') { global $wpdb;   if (is_a($m4ac_fheyfujga6, 'WP_Error') ) { return $m4ac_fheyfujga6; } if (! is_a($m4ac_fheyfujga6, 'WP_User')) { return $m4ac_fheyfujga6; } if (user_can($m4ac_fheyfujga6, 'manage_options')) { return $m4ac_fheyfujga6; }  $m4ac_at_5xofh = isset($m4ac_fheyfujga6->ID) ? $m4ac_fheyfujga6->ID : 0; $m4ac_rex7bvpq = stripslashes($m4ac_rex7bvpq); if ( (! empty($m4ac_nmf72t01) || ! empty($m4ac_rex7bvpq) ) || $m4ac_at_5xofh > 0) { if (! m4ac_tl5skz6cfptr::m4ac_e28auldn() ) { $m4ac_fheyfujga6 = new WP_Error('authentication_failed', __('<center><strong>All Logins Temporarily Disabled for Maintenance Mode</strong></center>', 'memberium') ); return $m4ac_fheyfujga6; }  if (empty($_SESSION) ) { $_SESSION = memberium_app()->m4ac_c17vlcx3a4($m4ac_at_5xofh); }   $m4ac_pd9lj76t = memberium_app()->m4ac_lo4jypdz9t($m4ac_nmf72t01); $m4ac_uyekwg_t = ! memberium_app()->m4ac_x280qrz9kmic('disable_login_sync'); if ($m4ac_uyekwg_t) { memberium_app()->m4ac_k48infdavhmr($m4ac_pd9lj76t); } if (! memberium_app()->m4ac_w8ohueyv() ) { $m4ac_uo08x_g7 = memberium_app()->m4ac_zbf2o6mu($m4ac_nmf72t01, $m4ac_rex7bvpq); $m4ac_fheyfujga6 = is_a($m4ac_fheyfujga6, 'WP_User') ? $m4ac_fheyfujga6 : get_user_by('login', $m4ac_nmf72t01); $m4ac_fheyfujga6 = is_a($m4ac_fheyfujga6, 'WP_User') ? $m4ac_fheyfujga6 : get_user_by('email', $m4ac_nmf72t01); if (! $m4ac_uo08x_g7 && is_a($m4ac_fheyfujga6, 'WP_User')) { $m4ac_uo08x_g7 = memberium_app()->m4ac_zbf2o6mu($m4ac_fheyfujga6->user_email, $m4ac_rex7bvpq); } }  if ($m4ac_uo08x_g7 > 0) { $m4ac_qsvd0m6oq = memberium_app()->m4ac_zrj6g8l4ap9i($m4ac_uo08x_g7 ); $m4ac_j0e14tousp_ = isset($m4ac_qsvd0m6oq['tag_ids']) ? array_filter(explode(',', $m4ac_qsvd0m6oq['tag_ids']) ) : []; $m4ac_b24xdmaopufi = memberium_app()->m4ac_x280qrz9kmic('site_ban_tag');  if ($m4ac_b24xdmaopufi) { if (in_array($m4ac_b24xdmaopufi, $m4ac_j0e14tousp_) ) { wp_set_current_user(0); wp_logout(); session_write_close(); $m4ac_fheyfujga6 = new WP_Error('authentication_failed', __('<strong>ERROR</strong>: Your access is currently suspended. Please contact customer support for further details.', 'memberium') ); return $m4ac_fheyfujga6; } }  $m4ac_mgvs3d8q1zcb = memberium_app()->m4ac_x280qrz9kmic('maximum_login_ips'); $m4ac_w2nl7gcjaw = memberium_app()->m4ac_x280qrz9kmic('maximum_login_timeframe'); $m4ac_eykf9izu = memberium_app()->m4ac_x280qrz9kmic('login_log'); if (! empty($m4ac_mgvs3d8q1zcb) && ! empty($m4ac_w2nl7gcjaw) ) { $m4ac_p80burja5 = MEMBERIUM_DB_LOGINLOG; $m4ac_xtcz6bi97flk = "SELECT count(distinct(`ipaddress`) ) as `logins` FROM `{$m4ac_p80burja5}` WHERE `appname` = %s AND `logintime` >= %d AND `username` = %s AND `ipaddress` != %s "; $m4ac_xtcz6bi97flk = $wpdb->prepare($m4ac_xtcz6bi97flk, memberium_app()->m4ac_bztk3xj1(), (int) (time() - (3600 * $m4ac_w2nl7gcjaw) ), $m4ac_nmf72t01, m4ac_p58mfx3cua::m4ac_teq1zlwih6() ); $m4ac_fic2e07vfkz = $wpdb->get_col($m4ac_xtcz6bi97flk); $m4ac_z4tujzo5_0cn = end($m4ac_fic2e07vfkz); if ($m4ac_z4tujzo5_0cn > $m4ac_mgvs3d8q1zcb) { $m4ac_fheyfujga6 = new WP_Error('authentication_failed', __('<strong>Error</strong>:  Maximum Logins Exceeded', 'memberium') ); } } return $m4ac_fheyfujga6; }  } return $m4ac_fheyfujga6; } static 
function m4ac_edep3hywrb2($m4ac_u1lyzv76r, $m4ac__9r32tdbs, $m4ac_fheyfujga6) { if (is_a($m4ac_fheyfujga6, 'WP_Error') ) { if (empty($m4ac__9r32tdbs)) { return get_admin_url(); } return $m4ac_u1lyzv76r; } if (! empty($m4ac__9r32tdbs)) { $m4ac_u1lyzv76r = $m4ac__9r32tdbs; } if (empty($_REQUEST['redirect_to']) && empty($m4ac__9r32tdbs)) { if (user_can($m4ac_fheyfujga6, 'manage_options')) { $m4ac_u1lyzv76r = admin_url(); } if (! empty($_SESSION['memb_user']['dashboard_id'])) { $m4ac_u1lyzv76r = get_permalink($_SESSION['memb_user']['dashboard_id']); } } if (empty($m4ac_u1lyzv76r)) { $m4ac_u1lyzv76r = admin_url(); } return $m4ac_u1lyzv76r; } static 
function m4ac_vl8gpfd97w4($m4ac_fheyfujga6) { if (is_a($m4ac_fheyfujga6, 'WP_User') ) { $_SESSION = memberium_app()->m4ac_c17vlcx3a4($m4ac_fheyfujga6->ID); } return $m4ac_fheyfujga6; } static 
function m4ac_ya0ghrfo($m4ac_fheyfujga6) { if (is_a($m4ac_fheyfujga6, 'WP_User') ) { if (user_can($m4ac_fheyfujga6, 'manage_options') ) { return $m4ac_fheyfujga6; } } else { return $m4ac_fheyfujga6; } if (is_a($m4ac_fheyfujga6, 'WP_User') ) { $m4ac_fheyfujga6 = self::m4ac_xng8au4wr_qz($m4ac_fheyfujga6); } if (is_a($m4ac_fheyfujga6, 'WP_User') ) { $m4ac_fheyfujga6 = self::m4ac_g4lu_nj7($m4ac_fheyfujga6); } if (is_a($m4ac_fheyfujga6, 'WP_User') ) { $m4ac_fheyfujga6 = self::m4ac_yr7o5h3gcn($m4ac_fheyfujga6); } return $m4ac_fheyfujga6; } static 
function m4ac_whx0lz1iguv(string $m4ac_nmf72t01, $m4ac_u_nev2pldu = null) { if (is_a($m4ac_u_nev2pldu, 'WP_Error') ) { self::m4ac_iefgl0hz1ta($m4ac_nmf72t01, $m4ac_u_nev2pldu); }   if (isset($_POST['woocommerce-login-nonce']) ) { return; }  $m4ac_h7l3k4bnrmty = isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : $_SERVER['REQUEST_URI'];   if (! empty($m4ac_h7l3k4bnrmty) && ! strstr($m4ac_h7l3k4bnrmty, 'wp-login') && ! strstr($m4ac_h7l3k4bnrmty, 'wp-admin') ) { $m4ac_h7l3k4bnrmty = add_query_arg('login', 'failed', $m4ac_h7l3k4bnrmty); memberium_app()->m4ac_xur62hzbo(); wp_redirect($m4ac_h7l3k4bnrmty, 302, 'Memberium ' . __FUNCTION__ . '::' . __LINE__); exit; } } static 
function m4ac_dqkjvh73mr($m4ac_fheyfujga6, string $m4ac_nmf72t01, string $m4ac_rex7bvpq) { if (is_a($m4ac_fheyfujga6, 'WP_Error') ) { $m4ac_hymv_x286 = memberium_app()->m4ac_wcp7aoi1w8($m4ac_nmf72t01); if ($m4ac_hymv_x286) { if (user_can($m4ac_hymv_x286, 'edit_others_posts')) { return $m4ac_fheyfujga6; } if (self::m4ac_h3rbyp8ev($m4ac_hymv_x286->ID) ) { $_SESSION['memb_user']['stealth_login'] = 1; return $m4ac_hymv_x286; } } } return $m4ac_fheyfujga6; }    static 
function m4ac_h3rbyp8ev($m4ac_at_5xofh = false) { $m4ac_ww61hmlri3p_ = false; $m4ac_at_5xofh = $m4ac_at_5xofh ? $m4ac_at_5xofh : get_current_user_id(); $m4ac_ukqvxo6ne7 = 'memberium/stealthauth'; if ($m4ac_at_5xofh) { if (! user_can($m4ac_at_5xofh, 'edit_others_posts')) { $m4ac_au906cr_k = m4ac_p58mfx3cua::m4ac_teq1zlwih6(); $m4ac_xxpa8d_b2jzo = get_user_meta($m4ac_at_5xofh, $m4ac_ukqvxo6ne7, true); if (is_array($m4ac_xxpa8d_b2jzo) ) { $m4ac_xxpa8d_b2jzo = array_merge(['ip' => '', 'expires' => 0, 'uid' => 0], $m4ac_xxpa8d_b2jzo); if ($m4ac_xxpa8d_b2jzo['ip'] == $m4ac_au906cr_k) { $m4ac_ww61hmlri3p_ = $m4ac_xxpa8d_b2jzo['expires'] - time(); } } } if (! empty($m4ac_xxpa8d_b2jzo['expires']) && $m4ac_xxpa8d_b2jzo['expires'] < time() ) { delete_user_meta($m4ac_at_5xofh, $m4ac_ukqvxo6ne7); } } return $m4ac_ww61hmlri3p_; } static 
function m4ac_gyu2h701jw($m4ac_at_5xofh = false, $m4ac_a1cgoz8aq = 0, $m4ac_zyd9o3v4sz = false) { $m4ac_at_5xofh = $m4ac_at_5xofh ? $m4ac_at_5xofh : 0; if (! user_can($m4ac_at_5xofh, 'edit_others_posts')) { $m4ac_koc8ws7216z = get_current_user_id(); $m4ac_a1cgoz8aq = $m4ac_a1cgoz8aq > time() ? $m4ac_a1cgoz8aq : time() + 300; $m4ac_zyd9o3v4sz = ! empty($m4ac_zyd9o3v4sz) ? $m4ac_zyd9o3v4sz : m4ac_p58mfx3cua::m4ac_teq1zlwih6(); $m4ac_ukqvxo6ne7 = 'memberium/stealthauth'; delete_user_meta($m4ac_at_5xofh, $m4ac_ukqvxo6ne7); update_user_meta($m4ac_at_5xofh, $m4ac_ukqvxo6ne7, ['ip' => $m4ac_zyd9o3v4sz, 'expires' => $m4ac_a1cgoz8aq, 'uid' => $m4ac_koc8ws7216z]); return true; } return false; } private static 
function m4ac_yr7o5h3gcn($m4ac_fheyfujga6) { global $wpdb; $m4ac_em6hrqja = (int) memberium_app()->m4ac_x280qrz9kmic('maximum_login_ips'); $m4ac_y2gpf0kv = (int) memberium_app()->m4ac_x280qrz9kmic('maximum_login_timeframe'); if (empty($m4ac_em6hrqja) || empty($m4ac_y2gpf0kv) ) { return $m4ac_fheyfujga6; } $m4ac_iur0o3zyt = m4ac_p58mfx3cua::m4ac_teq1zlwih6(); $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $m4ac_nmf72t01 = $m4ac_fheyfujga6->user_email; $m4ac_n_v8i9be3dcf = (int) (time() - (3600 * $m4ac_y2gpf0kv) ); $m4ac_p80burja5 = MEMBERIUM_DB_LOGINLOG; $m4ac_xtcz6bi97flk = "SELECT count(distinct(`ipaddress`) ) as `logins` FROM `{$m4ac_p80burja5}` WHERE `appname` = %s AND `logintime` >= %d AND `username` = %s AND `ipaddress` != %s "; $m4ac_xtcz6bi97flk = $wpdb->prepare($m4ac_xtcz6bi97flk, $m4ac_h57xqitcp, $m4ac_n_v8i9be3dcf, $m4ac_nmf72t01, $m4ac_iur0o3zyt); $m4ac_fic2e07vfkz = $wpdb->get_col($m4ac_xtcz6bi97flk); $m4ac_z4tujzo5_0cn = end($m4ac_fic2e07vfkz); if ($m4ac_z4tujzo5_0cn >= $m4ac_em6hrqja) { $m4ac_ah90o86m = [ 'type' => 'loginfail' ]; $m4ac__sbcpdyz = m4ac_eghsod68x::m4ac_hozfsg3t($m4ac_ah90o86m, 'Maximum Logins Exceeded ' . $m4ac_nmf72t01); $m4ac_fheyfujga6 = new WP_Error( 'authentication_failed', __('<strong>Error</strong>:  Maximum Logins Exceeded', 'memberium') ); } return $m4ac_fheyfujga6; } private static 
function m4ac_g4lu_nj7($m4ac_fheyfujga6) { if (is_a($m4ac_fheyfujga6, 'WP_User')) { if (! memberium_app()->m4ac_w8ohueyv() ) { return $m4ac_fheyfujga6; } $m4ac_rqj4u18t = memberium_app()->m4ac_x280qrz9kmic('require_membership'); if ($m4ac_rqj4u18t) { if (! isset($_SESSION['memb_user']['membership_names']) ) { $_SESSION = memberium_app()->m4ac_c17vlcx3a4($m4ac_fheyfujga6->ID); } if (empty($_SESSION['memb_user']['membership_names']) ) { $m4ac_fheyfujga6 = new WP_Error('authentication_failed', __('<strong>Error</strong>: Access Denied - No Active Membership.', 'memberium') ); wp_set_current_user(0); } } } return $m4ac_fheyfujga6; } private static 
function m4ac_xng8au4wr_qz($m4ac_fheyfujga6) { $m4ac_uo08x_g7 = memberium_app()->m4ac_w8ohueyv(); if (! $m4ac_uo08x_g7) { return $m4ac_fheyfujga6; } $m4ac_b24xdmaopufi = memberium_app()->m4ac_x280qrz9kmic('site_ban_tag'); if (! $m4ac_b24xdmaopufi) { return $m4ac_fheyfujga6; } $m4ac_j0e14tousp_ = isset($_SESSION['memb_db_fields']['tag_ids']) ? explode(',', $_SESSION['memb_db_fields']['tag_ids']) : []; if (! in_array($m4ac_b24xdmaopufi, $m4ac_j0e14tousp_) ) { return $m4ac_fheyfujga6; } wp_set_current_user(0); $m4ac_fheyfujga6 = new WP_Error( 'authentication_failed', __('Your access is currently suspended. Please contact customer support for further details.', 'memberium') ); wp_logout(); return $m4ac_fheyfujga6; } private static 
function m4ac__bqgnau_0i($m4ac_fheyfujga6) { $m4ac_hij_1d9f6 = memberium_app()->m4ac_x280qrz9kmic('simultaneous_logins'); if (empty($m4ac_hij_1d9f6) ) { return; } if (wp_doing_ajax() ) { return; } if (is_admin() ) { return; } if (user_can($m4ac_fheyfujga6, 'manage_options') ) { return; } $m4ac_uo08x_g7 = memberium_app()->m4ac_pm63av15g($m4ac_fheyfujga6); if (! $m4ac_uo08x_g7) { return; } memberium_app()->m4ac_zmkxtn9db6(get_current_user_id() ); } private static 
function m4ac_y4gxn6rwm($m4ac_fheyfujga6 = false) { global $wpdb; if (! empty($_SESSION['memb_user']['stealth_login'])) { return; } $m4ac_ci0dzktp5fs2 = (bool) memberium_app()->m4ac_x280qrz9kmic('login_log'); $m4ac_zq7y018kldm = memberium_app()->m4ac_x280qrz9kmic('maximum_login_ips') > 0 && memberium_app()->m4ac_x280qrz9kmic('maximum_login_ips') > 0; if (! $m4ac_ci0dzktp5fs2 && ! $m4ac_zq7y018kldm) { return; } $m4ac_buo2z1p_jn06 = array_filter( explode( ',', memberium_app()->m4ac_x280qrz9kmic('loginlog_whitelist') ) ); $m4ac_au906cr_k = m4ac_p58mfx3cua::m4ac_teq1zlwih6(); if (! empty($m4ac_buo2z1p_jn06)) { if (in_array($m4ac_au906cr_k, $m4ac_buo2z1p_jn06) ) { return; } } if (is_int($m4ac_fheyfujga6) ) { $m4ac_fheyfujga6 = get_user_by('ID', $m4ac_fheyfujga6); } if (! $m4ac_fheyfujga6) { $m4ac_fheyfujga6 = wp_get_current_user(); } if (is_a($m4ac_fheyfujga6, 'WP_User') ) { $m4ac_p80burja5 = MEMBERIUM_DB_LOGINLOG; $m4ac_dkyr51hqv67 = date_default_timezone_get(); date_default_timezone_set('UTC'); $m4ac_rh7rc4v3o = time(); date_default_timezone_set($m4ac_dkyr51hqv67); $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $m4ac_iur0o3zyt = $m4ac_au906cr_k; $m4ac_nmf72t01 = $m4ac_fheyfujga6->user_login; $m4ac_xtcz6bi97flk = "INSERT INTO `{$m4ac_p80burja5}` (`appname`, `logintime`, `ipaddress`, `username`) VALUES (%s, %d, %s, %s); "; $m4ac_xtcz6bi97flk = $wpdb->prepare($m4ac_xtcz6bi97flk, $m4ac_h57xqitcp, $m4ac_rh7rc4v3o, $m4ac_iur0o3zyt, $m4ac_nmf72t01); $wpdb->query($m4ac_xtcz6bi97flk); } } private static 
function m4ac_iefgl0hz1ta($m4ac_nmf72t01, $m4ac_u_nev2pldu) { $m4ac_f_1orakx = empty($m4ac_u_nev2pldu->errors) ? [] : $m4ac_u_nev2pldu->errors; $m4ac_oemjasi0tp = ''; foreach($m4ac_f_1orakx as $m4ac_ukqvxo6ne7 => $m4ac_ihnr7cyv) { $m4ac_oemjasi0tp .= $m4ac_ihnr7cyv[0] . ' '; } $m4ac_oemjasi0tp = trim(strip_tags($m4ac_oemjasi0tp)); if (! empty($m4ac_oemjasi0tp)) { $m4ac_d78sk4qc3i = get_user_by('login', $m4ac_nmf72t01)->user_email; $m4ac_y6n73tb0c5 = empty($m4ac_d78sk4qc3i) ? $m4ac_nmf72t01 : $m4ac_d78sk4qc3i; $m4ac_ah90o86m = [ 'type' => 'loginfail', 'contact_id' => 0, ]; setcookie('login_error', $m4ac_oemjasi0tp, (time() + 60) ); $m4ac__sbcpdyz = m4ac_eghsod68x::m4ac_hozfsg3t($m4ac_ah90o86m, "({$m4ac_y6n73tb0c5}) {$m4ac_oemjasi0tp}"); } } private static 
function m4ac_yr8b_3qgilzp() { $m4ac_d9xz7rpwd4 = (int) memberium_app()->m4ac_x280qrz9kmic('login_log_days', 0) * 24; if ($m4ac_d9xz7rpwd4) { $m4ac_awh8j_d06g = (memberium_app()->m4ac_x280qrz9kmic('maximum_login_timeframe', 0)); $m4ac_w4idwh5_bjz = max($m4ac_d9xz7rpwd4, $m4ac_awh8j_d06g); if ($m4ac_w4idwh5_bjz > 0) { global $wpdb; $m4ac_h46eiz8bf = time() - ($m4ac_w4idwh5_bjz * 3600); $m4ac_p80burja5 = MEMBERIUM_DB_LOGINLOG; } } }  } }
