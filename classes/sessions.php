<?php
/**
 * Copyright (c) 2012-2021 David J Bullock
 * Web Power and Light
 */

 if (class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac_hpc5iv6omh { static 
function m4ac_w07mrqh2sxlp() { self::$m4ac_ytso7l_aw = 0; self::$m4ac_xlh1ea246g = self::m4ac_r8_n0gzlqrm3(); self::$m4ac_jouqjei9gbc3 = self::m4ac_jau2sm3yj0g(); self::$m4ac_nq4r6f2paw = wp_using_ext_object_cache(); self::$m4ac_z2h1g0j9aeq3 = (int) max(ini_get('session.gc_maxlifetime'), 14400); if (! headers_sent() ) { session_set_save_handler( [__CLASS__, 'm4ac_m05prnz3'], [__CLASS__, 'm4ac_i1jcgxnpfulr'], [__CLASS__, 'm4ac_b5fky6jtgb9c'], [__CLASS__, 'm4ac__9wytl8g'], [__CLASS__, 'm4ac_g5hkweo7zlun'], [__CLASS__, 'm4ac_ngqsmwtpyfu'] );  } } static 
function m4ac_r8_n0gzlqrm3() { if (empty(self::$m4ac_xlh1ea246g) ) { self::$m4ac_xlh1ea246g = function_exists('gzuncompress') && function_exists('gzcompress'); } return self::$m4ac_xlh1ea246g; } static 
function m4ac_jau2sm3yj0g() { if (empty(self::$m4ac_jouqjei9gbc3) ) { self::$m4ac_jouqjei9gbc3 = $GLOBALS['wpdb']->prefix . 'memberium_sessions'; } return self::$m4ac_jouqjei9gbc3; } static 
function m4ac_oj1ufblyhz() { if (is_null(self::$m4ac_nq4r6f2paw) ) { self::$m4ac_nq4r6f2paw = wp_using_ext_object_cache(); } return self::$m4ac_nq4r6f2paw; } static 
function m4ac_zer3f9lk4s(bool $m4ac_i2qtr6afhmyx) { self::$m4ac_ytso7l_aw = $m4ac_i2qtr6afhmyx; return true; } static 
function m4ac_el69wtinfr(int $m4ac_z2h1g0j9aeq3) { self::$m4ac_z2h1g0j9aeq3 = $m4ac_z2h1g0j9aeq3; return true; }    static 
function m4ac_i1jcgxnpfulr() { return true; } static 
function m4ac_m05prnz3(string $m4ac_w61rnivlq08, string $m4ac_b12biy07_6rv) { return true; } static 
function m4ac_ngqsmwtpyfu(int $m4ac_irowvsgazx4m = 0) {  $m4ac_jouqjei9gbc3 = self::m4ac_jau2sm3yj0g(); $m4ac_xtcz6bi97flk = "DELETE FROM `{$m4ac_jouqjei9gbc3}` WHERE `expiration` < " . time() . " OR value = ''; " ; $m4ac_x_1sx47rpefc = $GLOBALS['wpdb']->query($m4ac_xtcz6bi97flk); return true; } static 
function m4ac_g5hkweo7zlun(string $m4ac_ukqvxo6ne7) { if (self::m4ac_oj1ufblyhz() ) { wp_cache_delete($m4ac_ukqvxo6ne7, self::$m4ac_tdgkfyzx); } $m4ac_jouqjei9gbc3 = self::m4ac_jau2sm3yj0g(); $m4ac_xtcz6bi97flk = "DELETE FROM {$m4ac_jouqjei9gbc3} WHERE `session_key` = %s"; $m4ac_xtcz6bi97flk = $GLOBALS['wpdb']->prepare($m4ac_xtcz6bi97flk, $m4ac_ukqvxo6ne7); $m4ac_fic2e07vfkz = $GLOBALS['wpdb']->query($m4ac_xtcz6bi97flk); return true; } static 
function m4ac_b5fky6jtgb9c(string $m4ac_ukqvxo6ne7) { if (self::m4ac_oj1ufblyhz() ) { $m4ac_md7c8zsu2o = wp_cache_get($m4ac_ukqvxo6ne7, self::$m4ac_tdgkfyzx, false, $m4ac_tp09y21w7hcn); if ($m4ac_tp09y21w7hcn) { wp_cache_set($m4ac_ukqvxo6ne7, $m4ac_md7c8zsu2o, self::$m4ac_tdgkfyzx, self::$m4ac_z2h1g0j9aeq3); return $m4ac_md7c8zsu2o; } } global $wpdb; $m4ac_jouqjei9gbc3 = self::m4ac_jau2sm3yj0g(); $m4ac_xtcz6bi97flk = "SELECT `value`, `expiration` FROM `{$m4ac_jouqjei9gbc3}` WHERE `session_key` = %s "; $m4ac_xtcz6bi97flk = $wpdb->prepare($m4ac_xtcz6bi97flk, $m4ac_ukqvxo6ne7); $m4ac_md7c8zsu2o = $wpdb->get_results($m4ac_xtcz6bi97flk, ARRAY_A); $m4ac_md7c8zsu2o = isset($m4ac_md7c8zsu2o[0]) ? $m4ac_md7c8zsu2o[0] : []; if (empty($m4ac_md7c8zsu2o['value']) ) { return ''; } $m4ac_lqxwdb02o = $m4ac_md7c8zsu2o['expiration'] - time(); $m4ac_pxjhe65vq4w = 0.5 * self::$m4ac_z2h1g0j9aeq3; if ($m4ac_lqxwdb02o < $m4ac_pxjhe65vq4w) { $m4ac_xtcz6bi97flk = "UPDATE `{$m4ac_jouqjei9gbc3}` SET `expiration` = %d WHERE `session_key` = %s "; $m4ac_xtcz6bi97flk = $wpdb->prepare($m4ac_xtcz6bi97flk, time() + self::$m4ac_z2h1g0j9aeq3, $m4ac_ukqvxo6ne7); $wpdb->query($m4ac_xtcz6bi97flk); } if (self::m4ac_r8_n0gzlqrm3() && substr($m4ac_md7c8zsu2o['value'], 0, 2) == 'eN') { $m4ac_md7c8zsu2o = gzuncompress(base64_decode($m4ac_md7c8zsu2o['value']) ); } session_decode($m4ac_md7c8zsu2o); return $m4ac_md7c8zsu2o; } static 
function m4ac__9wytl8g(string $m4ac_ukqvxo6ne7, string $m4ac_md7c8zsu2o) { global $user_email, $user_login, $wpdb; if (self::m4ac_oj1ufblyhz() ) { if (empty($m4ac_md7c8zsu2o)) { wp_cache_delete($m4ac_ukqvxo6ne7, self::$m4ac_tdgkfyzx); } wp_cache_set($m4ac_ukqvxo6ne7, $m4ac_md7c8zsu2o, self::$m4ac_tdgkfyzx, self::$m4ac_z2h1g0j9aeq3); } if (empty($m4ac_md7c8zsu2o) ) { return true; } $m4ac_jouqjei9gbc3 = self::m4ac_jau2sm3yj0g(); $m4ac_ashwynmuv0o2 = (! empty($user_login) ) ? strtolower($user_login) : ''; $m4ac_xokhbdygzjnq = (! empty($user_email) ) ? strtolower($user_email) : '';  if (self::$m4ac_ytso7l_aw) { if ($m4ac_xokhbdygzjnq > '' && isset($_SESSION['admin']) && (int) $_SESSION['admin'] == 0) { $m4ac_xtcz6bi97flk = "DELETE FROM `{$m4ac_jouqjei9gbc3}` WHERE `email_key` = %s AND `session_key` <> %s"; $m4ac_xtcz6bi97flk = $wpdb->prepare($m4ac_xtcz6bi97flk, $m4ac_xokhbdygzjnq, $m4ac_ukqvxo6ne7); $m4ac_x_1sx47rpefc = $wpdb->query($m4ac_xtcz6bi97flk); } }  if (self::m4ac_r8_n0gzlqrm3() ) { $m4ac_md7c8zsu2o = base64_encode(gzcompress($m4ac_md7c8zsu2o, 9) ); }  $m4ac_xtcz6bi97flk = "REPLACE INTO `{$m4ac_jouqjei9gbc3}` (session_key, email_key, expiration, value) VALUES (%s, %s, %d, %s)"; $m4ac_xtcz6bi97flk = $wpdb->prepare($m4ac_xtcz6bi97flk, $m4ac_ukqvxo6ne7, $m4ac_xokhbdygzjnq, time() + self::$m4ac_z2h1g0j9aeq3, $m4ac_md7c8zsu2o); $m4ac_x_1sx47rpefc = $wpdb->query($m4ac_xtcz6bi97flk); return $wpdb->insert_id; } private 
function __construct() {} private static $m4ac_ytso7l_aw = false; private static $m4ac_jouqjei9gbc3 = ''; private static $m4ac_nq4r6f2paw = null; private static $m4ac_z2h1g0j9aeq3 = 14400; private static $m4ac_xlh1ea246g = null; private static $m4ac_tdgkfyzx = 'memberiumac/sessions'; } }
