<?php
/**
* Copyright (c) 2021 David J Bullock
* Web Power and Light, LLC
* https://webpowerandlight.com
* support@webpowerandlight.com
*
*/

 if (class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac_ulsfthjvam { static private $m4ac_ccn07vmlhdg = 'production'; static private $m4ac_n2kqiyparg5 = '<a href="https://memberium.com/support/" target="_blank">contact support</a>'; private 
function __construct() { }  static 
function m4ac_puvdaerlsk2m( array $m4ac_jpwyv954sc2 ) : array { self::$m4ac_ccn07vmlhdg = defined('WP_ENVIRONMENT_TYPE') ? WP_ENVIRONMENT_TYPE : self::$m4ac_ccn07vmlhdg; self::$m4ac_ccn07vmlhdg = function_exists('WP_ENVIRONMENT_TYPE') ? wp_get_environment_type() : self::$m4ac_ccn07vmlhdg; $m4ac_vce19jkg62b = memberium_app()->m4ac_lx4jv6fi7k(); $m4ac__05hpcag6ve = strtoupper(MEMBERIUM_SKU); $m4ac_w386fgqma2 = m4ac_tl5skz6cfptr::m4ac_a9x5p_oeaqu1(); $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $m4ac_z2561jxq = memberium_app()->m4ac_x280qrz9kmic('ac_api_url', ''); $m4ac_il1s6zenby8w = substr(memberium_app()->m4ac_x280qrz9kmic('ac_api_key', ''), 0, 10) . '*********'; $m4ac_t3cu9hgt = count(get_option(MEMBERIUM_MEMBERSHIP_SETTINGS, []) ); $m4ac_kk6w4geb3 = defined('WP_MEMORY_LIMIT') ? WP_MEMORY_LIMIT : 'Undefined'; $m4ac_jgniouf_v = php_uname('n'); $m4ac_w9gj_xiqo = memberium_app()->m4ac_cbc5pz_ng4(); $m4ac_cpumy5vwzb2x = wp_get_update_data(); $m4ac_eko410z8ed = self::m4ac_da_oulvn(); $m4ac_k9k5lp46 = self::m4ac_dau279chx_b(); $m4ac_dgoehy3jca6r = self::m4ac_mxa8e23ultw(); $m4ac_tp571rtc = (bool) memberium_app()->m4ac_x280qrz9kmic('autoupdate'); if (is_array($m4ac_w386fgqma2)) { $m4ac_clcuwypr15n = [ 'Active' => empty($m4ac_w386fgqma2['active']) ? 'No' : 'Yes', 'Max Users' => empty($m4ac_w386fgqma2['max_users']) ? 0 : $m4ac_w386fgqma2['max_users'], 'Hostname' => isset($m4ac_w386fgqma2['hostname']) ? $m4ac_w386fgqma2['hostname'] : 'Unknown', 'Owner Email' => isset($m4ac_w386fgqma2['owner_email']) ? $m4ac_w386fgqma2['owner_email'] : 'Unknown', 'License Name' => isset($m4ac_w386fgqma2['license_name']) ? $m4ac_w386fgqma2['license_name'] : 'Unknown', 'Tags' => isset($m4ac_w386fgqma2['tags']) ? $m4ac_w386fgqma2['tags'] : 'None', ]; } else { $m4ac_clcuwypr15n = 'None'; } if (isset($m4ac_jpwyv954sc2['wp-core']['fields']['version']) ) { $m4ac_jpwyv954sc2['wp-core']['fields']['version']['value'] = $m4ac_w9gj_xiqo; $m4ac_jpwyv954sc2['wp-core']['fields']['version']['debug'] = $m4ac_w9gj_xiqo; } $m4ac_ip6o9fri = [ 'wp-core' => $m4ac_jpwyv954sc2['wp-core'], 'wpal-memberium' => [ 'label' => 'Memberium', 'fields' => [ 'sku' => [ 'label' => 'SKU', 'value' => $m4ac__05hpcag6ve, 'private' => false, ], 'version' => [ 'label' => 'Installed Version', 'value' => $m4ac_vce19jkg62b, 'private' => false, ], 'license' => [ 'label' => 'License', 'value' => $m4ac_clcuwypr15n, 'private' => false, ], 'autoupdate' => [ 'label' => 'Autoupdate', 'value' => empty($m4ac_tp571rtc) ? 'No' : 'Yes', 'private' => false, ], 'app_name' => [ 'label' => 'ActiveCampaign App', 'value' => $m4ac_h57xqitcp, 'private' => false, ], 'app_url' => [ 'label' => 'ActiveCampaign API URL', 'value' => $m4ac_z2561jxq, 'private' => false, ], 'api_key' => [ 'label' => 'ActiveCampaign API Key', 'value' => $m4ac_il1s6zenby8w, 'private' => true, ], 'hostname' => [ 'label' => 'Hostname', 'value' => $m4ac_jgniouf_v, 'private' => false, ], 'proxies' => [ 'label' => 'Proxies', 'value' => empty($m4ac_dgoehy3jca6r['data']) ? 'None' : $m4ac_dgoehy3jca6r['data'], 'private' => false, ], 'ssl' => [ 'label' => 'SSL', 'value' => is_ssl() ? 'Yes' : 'No', 'private' => false, ], 'php_version' => [ 'label' => 'PHP Version', 'value' => phpversion(), 'private' => false, ], 'wp_version' => [ 'label' => 'WordPress Version', 'value' => memberium_app()->m4ac_cbc5pz_ng4(), 'private' => false, ], 'plugins/caching' => [ 'label' => 'Caching Plugins', 'value' => empty($m4ac_eko410z8ed['data']) ? 'None' : $m4ac_eko410z8ed['data'], 'private' => false, ], 'plugins/membership' => [ 'label' => 'Membership Plugins', 'value' => empty($m4ac_k9k5lp46['data']) ? 'None' : $m4ac_k9k5lp46['data'], 'private' => false, ], 'updates/plugins' => [ 'label' => 'Outdated Plugins', 'value' => empty($m4ac_cpumy5vwzb2x['plugins']) ? 0 : $m4ac_cpumy5vwzb2x['plugins'], 'private' => false, ], 'updates/themes' => [ 'label' => 'Outdated Themes', 'value' => empty($m4ac_cpumy5vwzb2x['themes']) ? 0 : $m4ac_cpumy5vwzb2x['themes'], 'private' => false, ], 'updates/core' => [ 'label' => 'Outdated WordPress Core', 'value' => empty($m4ac_cpumy5vwzb2x['wordpress']) ? 0 : $m4ac_cpumy5vwzb2x['wordpress'], 'private' => false, ], 'object_cache' => [ 'label' => 'Object Cache', 'value' => wp_using_ext_object_cache() ? 'Yes' : 'No', 'private' => false, ], 'memberships/count' => [ 'label' => 'Membership Levels', 'value' => $m4ac_t3cu9hgt, 'private' => false, ], 'users' => [ 'label' => 'Users', 'value' => m4ac_tl5skz6cfptr::m4ac_gd1pbm4e(), 'private' => false, ], 'tags/count' => [ 'label' => 'Tags', 'value' => self::m4ac_lwvgul7o4z(), 'private' => false, ], 'fields/count' => [ 'label' => 'Fields', 'value' => self::m4ac_qzy794sv(), 'private' => false, ], 'lists/count' => [ 'label' => 'Lists', 'value' => self::m4ac_tbnzodsc63fx(), 'private' => false, ], 'automations/count' => [ 'label' => 'Automations', 'value' => self::m4ac_epy367wr80zf(), 'private' => false, ],                     'shortcodes/nesting' => [ 'label' => 'Shortcode Nesting Levels', 'value' => MEMBERIUM_NESTING_LEVELS, 'private' => false, ], ], ] ]; return array_merge($m4ac_ip6o9fri, $m4ac_jpwyv954sc2); }  static 
function m4ac_lwvgul7o4z() : int { global $wpdb; $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $table_name = MEMBERIUM_DB_TAGS; $m4ac_xtcz6bi97flk = "SELECT count(id) from {$table_name} WHERE `appname` = '{$m4ac_h57xqitcp}' "; return (int) $wpdb->get_var($m4ac_xtcz6bi97flk); } static 
function m4ac_epy367wr80zf() : int { global $wpdb; $table_name = MEMBERIUM_DB_AUTOMATIONS; $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $m4ac_xtcz6bi97flk = "SELECT count(`id`) from `{$table_name}` WHERE `appname` = '{$m4ac_h57xqitcp}' AND `status` = 1;"; return (int) $wpdb->get_var($m4ac_xtcz6bi97flk); } static 
function m4ac_qzy794sv() : int { global $wpdb; $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $table_name = MEMBERIUM_DB_FIELDS; $m4ac_xtcz6bi97flk = "SELECT count(`id`) from `{$table_name}` WHERE `appname` = '{$m4ac_h57xqitcp}'"; return (int) $wpdb->get_var($m4ac_xtcz6bi97flk); } static 
function m4ac_tbnzodsc63fx() : int { global $wpdb; $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $table_name = MEMBERIUM_DB_LISTS; $m4ac_xtcz6bi97flk = "SELECT count(`id`) from `{$table_name}` WHERE `appname` = '{$m4ac_h57xqitcp}'"; return (int) $wpdb->get_var($m4ac_xtcz6bi97flk); }  static 
function m4ac_ympq0a_d6y(array $m4ac_specfrnq8bkl) : array { self::$m4ac_ccn07vmlhdg = defined('WP_ENVIRONMENT_TYPE') ? WP_ENVIRONMENT_TYPE : self::$m4ac_ccn07vmlhdg; self::$m4ac_ccn07vmlhdg = function_exists('WP_ENVIRONMENT_TYPE') ? wp_get_environment_type() : self::$m4ac_ccn07vmlhdg; if (self::$m4ac_ccn07vmlhdg === 'staging' || self::$m4ac_ccn07vmlhdg == 'local') { unset($m4ac_specfrnq8bkl['direct']['wpal/server/phpinfo']); if (false) { unset($m4ac_specfrnq8bkl['direct']['debug_enabled']); unset($m4ac_specfrnq8bkl['direct']['plugin_version']); unset($m4ac_specfrnq8bkl['direct']['theme_version']); } } $m4ac_specfrnq8bkl['direct']['wpal/memberium/performance/memory'] = [ 'label' => 'Memory Allocation', 'test' => [__CLASS__, 'm4ac_v9ip25bry'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/security/default_role'] = [ 'label' => 'Default Role', 'test' => [__CLASS__, 'm4ac_uijts6dg'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/security/caching'] = [ 'label' => 'Caching Plugins', 'test' => [__CLASS__, 'm4ac_rieq3az8m7wo'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/security/cloudflare'] = [ 'label' => 'Cloudflare', 'test' => [__CLASS__, 'm4ac_mxa8e23ultw'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/tables'] = [ 'label' => 'Database Tables', 'test' => [__CLASS__, 'm4ac_gcik7ugrbezj'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/flywheel'] = [ 'label' => 'FlyWheel Caching', 'test' => [__CLASS__, 'm4ac_u5kx1jdpb'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberiums/security/licenseserver'] = [ 'label' => 'Memberium License Server', 'test' => [__CLASS__, 'm4ac_tt7oha693ic'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/network_activation'] = [ 'label' => 'Memberium Network Activation', 'test' => [__CLASS__, 'm4ac_w87aikfhctdu'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/memberships'] = [ 'label' => 'Membership Setup', 'test' => [__CLASS__, 'm4ac_f25sze6ry'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/tags'] = [ 'label' => 'CRM Tag Sync', 'test' => [__CLASS__, 'm4ac_wg3s476y'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/installer/active'] = [ 'label' => 'Memberium Installer Plugin', 'test' => [__CLASS__, 'm4ac_qay2dsfoj'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/file_permissions'] = [ 'label' => 'Memberium File Permissions', 'test' => [__CLASS__, 'm4ac_hfk_ab8zgc3'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/mivc_plugin'] = [ 'label' => 'Menu Items Visibility Control Plugin Installed', 'test' => [__CLASS__, 'm4ac_vighwcoy3xa'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/admin_is_admin'] = [ 'label' => 'Admin User should be renamed', 'test' => [__CLASS__, 'm4ac_u_v13k0irzw'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/autoupdate'] = [ 'label' => 'Memberium Autoupdate', 'test' => [__CLASS__, 'elf_test_memberium_autoupdate'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/support_account'] = [ 'label' => 'Memberium Support users should be removed', 'test' => [__CLASS__, 'm4ac_n1nzup7e8i5'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/missing_autoincrement'] = [ 'label' => 'WordPress Database Corruption', 'test' => [__CLASS__, 'm4ac_vype2k7a'], ]; $m4ac_specfrnq8bkl['direct']['wpal/server/phpinfo'] = [ 'label' => 'PHPinfo() Security Issue', 'test' => [__CLASS__, 'm4ac_riz80b7rqf'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/open_registration'] = [ 'label' => 'Open Registration', 'test' => [__CLASS__, 'm4ac_crvfozhc'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/object_cache'] = [ 'label' => 'Object Caching', 'test' => [__CLASS__, 'm4ac_xnjr075umcyl'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/administrator_email'] = [ 'label' => 'Site Administrator Email', 'test' => [__CLASS__, 'm4ac_c63nfd9u4hba'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/goaddy/managed'] = [ 'label' => 'GoDaddy Managed Hosting', 'test' => [__CLASS__, 'm4ac_g5qfku72d0b'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/plugins/caching'] = [ 'label' => 'Caching Plugins', 'test' => [__CLASS__, 'm4ac_da_oulvn'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/plugins/membership'] = [ 'label' => 'Membership Plugins', 'test' => [__CLASS__, 'm4ac_dau279chx_b'], ]; $m4ac_specfrnq8bkl['direct']['wpal/wordpress/plugins/buddypress_private_network'] = [ 'label' => 'Possible BuddyPress Site Security Conflict', 'test' => [__CLASS__, 'm4ac_cbane_djs6l2'], ]; $m4ac_specfrnq8bkl['direct']['wpal/memberium/version'] = [ 'label' => 'Memberium Version', 'test' => [__CLASS__, 'm4ac_a80ixndszba'], ]; $m4ac_specfrnq8bkl['direct'][] = [ 'label' => 'wpal/memberium/tag_names', 'test' => [__CLASS__, 'm4ac_bl528vwrn'], ]; return $m4ac_specfrnq8bkl; }  static 
function m4ac_cbane_djs6l2() : array { $m4ac_fic2e07vfkz = []; if (function_exists('bp_is_active') || function_exists('buddypress') ) { $m4ac_oa17hzm_4 = get_option('bp-enable-private-network', 1); if ($m4ac_oa17hzm_4 == 0) { $m4ac_fic2e07vfkz = [ 'label' => 'BuddyPress Private Networking', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'orange', ], 'description' => "<p>Memberium has detected that you're using BuddyPress/BuddyBoss's private network feature.</p>", 'actions' => "<p>This feature may cause problems with page access controls.  We recommmend disabling this feature and letting Memberium manage site access.</p>", 'test' => 'wpal_wordpress_plugins_buddypress_private_network', ]; } } return $m4ac_fic2e07vfkz; } static 
function m4ac_da_oulvn() : array { if (! function_exists('get_plugins') ) { require_once ABSPATH . 'wp-admin/includes/plugin.php'; } $m4ac_fic2e07vfkz = []; $m4ac_xeslz6uj4 = array_merge(get_plugins(), get_mu_plugins() ); $m4ac_gcri_3ek = []; $m4ac_mv12qfd0jxr = [ 'endurance-page-cache.php', 'breeze/breeze.php', 'cache-enabler/cache-enabler.php', 'cachify/cachify.php', 'comet-cache/comet-cache.php', 'ezcache/ezcache.php', 'hummingbird-performance/wp-hummingbird.php', 'litespeed-cache/litespeed-cache.php', 'nginx-cache/nginx-cache.php', 'nginx-helper/nginx-helper.php', 'preload-fullpage-cache/preload-fullpage-cache.php', 'purge-varnish/class_purge_varnish.php', 'rapid-cache/rapid-cache.php', 'sg-cachepress/sg-cachepress.php', 'simple-cache/simple-cache.php', 'swift-performance-lite/performance.php', 'vcaching/vcaching.php', 'widget-output-cache/widget-output-cache.php', 'wp-cloudflare-page-cache/wp-cloudflare-super-page-cache.php', 'wp-fastest-cache/wpFastestCache.php', 'wp-super-cache/wp-cache.php', 'wpcacheon/wp-cache-on.php', ]; foreach($m4ac_mv12qfd0jxr as $m4ac_rxqa04teu2f) { if (array_key_exists($m4ac_rxqa04teu2f, $m4ac_xeslz6uj4)) { $m4ac_b54e9qp61xcg = $m4ac_xeslz6uj4[$m4ac_rxqa04teu2f]; $m4ac_w6baucteghm = isset($m4ac_b54e9qp61xcg['Name']) ? $m4ac_b54e9qp61xcg['Name'] : $m4ac_o1uhaeys7; $m4ac_jik4jc6e = isset($m4ac_b54e9qp61xcg['Version']) ? $m4ac_b54e9qp61xcg['Version'] : ''; $m4ac_gcri_3ek[] = $m4ac_w6baucteghm . ' v' . $m4ac_jik4jc6e; } } if (! empty($m4ac_gcri_3ek)) { $m4ac_fic2e07vfkz = [ 'label' => 'Caching Plugins Found', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>The following caching plugins were found installed on your system.  " . "Improper configuration of these plugins can cause problems including access controls being broken, data corruption, and the wrong information displayed to the wrong user.</p>", 'actions' => '<p>We recommend deactivating and removing these plugins.  ' . 'If the plugin is required, please ensure it is not caching logged in users or pages with secure forms.</p>', 'test' => 'wpal_wordpress_plugins_caching', 'data' => $m4ac_gcri_3ek, ]; foreach($m4ac_gcri_3ek as $m4ac_o9gv2ip5qe) { $m4ac_fic2e07vfkz['description'] .= $m4ac_o9gv2ip5qe . '<br />'; } } return $m4ac_fic2e07vfkz; } static 
function m4ac_vype2k7a() : array { global $wpdb; $m4ac_f92tkhgnzfcb = []; $m4ac_f_1orakx = []; $m4ac_kqzvwpxl7 = [ $wpdb->commentmeta => 'meta_id', $wpdb->comments => 'comment_ID', $wpdb->postmeta => 'meta_id', $wpdb->posts => 'ID', $wpdb->usermeta => 'umeta_id', $wpdb->users => 'ID', ]; foreach($m4ac_kqzvwpxl7 as $m4ac_jouqjei9gbc3 => $m4ac_abn3a_2v) { $m4ac_xtcz6bi97flk = "SELECT count(`{$m4ac_abn3a_2v}`) FROM `{$m4ac_jouqjei9gbc3}` WHERE `{$m4ac_abn3a_2v}` = 0"; $m4ac_g9fn685ibx = (int) $wpdb->get_var($m4ac_xtcz6bi97flk); if ($m4ac_g9fn685ibx) { $m4ac_f_1orakx[$m4ac_jouqjei9gbc3] = $m4ac_abn3a_2v; } } if (count($m4ac_f_1orakx) ) { $m4ac_f92tkhgnzfcb = [ 'label' => 'WordPress Database AutoIncrement Corruption', 'status' => 'critical', 'badge' => [ 'label' => __('Database'), 'color' => 'red', ], 'description' => "<p>Your WordPress database AutoIncrement columns are corrupted or missing, and is causing data loss.</p><p>The following tables are affected:</p>", 'actions' => '<p>We recommend you contact your hosting service and ask them to repair the damaged columns and indexes.</p>', 'test' => 'wpal_wordpress_autoincrement', ]; foreach($m4ac_f_1orakx as $m4ac_jouqjei9gbc3 => $m4ac_abn3a_2v) { $m4ac_f92tkhgnzfcb['description'] .= "Table: '{$m4ac_jouqjei9gbc3}', on column '{$m4ac_abn3a_2v}'<br />"; } } return $m4ac_f92tkhgnzfcb; } static 
function m4ac_uijts6dg() : array { $m4ac_lhsv2bcj94 = get_option('default_role'); $m4ac_cnjvkyitq = get_role($m4ac_lhsv2bcj94); $m4ac_pl6q5gcnx = $m4ac_cnjvkyitq->has_cap('read'); $m4ac_snl1ztosira = $m4ac_cnjvkyitq->has_cap('manage_options'); $m4ac_fic2e07vfkz = null; $m4ac_lhsv2bcj94 = ucwords($m4ac_lhsv2bcj94); $m4ac_fic2e07vfkz = [ 'label' => 'Default Role Permissions', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green' ], 'description' => '', 'actions' => '', 'test' => 'wpal_default_role', ]; if ($m4ac_snl1ztosira) { $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['description'] .= "<p>Your default role ({$m4ac_lhsv2bcj94}) appears to be mis-configured as an admin user.  The default role should have minimum access.</p>"; } if (! $m4ac_pl6q5gcnx) { $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['description'] .= "<p>Your default role ({$m4ac_lhsv2bcj94}) appears to be mis-configured without the 'Read' capability.  This capability should be added to the role.</p>"; } if ($m4ac_fic2e07vfkz['status'] == 'good') { $m4ac_fic2e07vfkz['description'] = 'Your default role appears to be properly configured.'; } else { $m4ac_fic2e07vfkz['actions'] = '<p>Please contact <a href="https://memberium.com/support/" target="_blank">Memberium Support</a> for assistance and include a copy of this message.</p>'; } return $m4ac_fic2e07vfkz; } static 
function m4ac_hfk_ab8zgc3() : array { $m4ac_m8eqcjfl0 = new RecursiveIteratorIterator(new RecursiveDirectoryIterator(MEMBERIUM_HOME_DIR)); $m4ac_rf3lt2m8kg_ = true; $m4ac_fic2e07vfkz = []; foreach ($m4ac_m8eqcjfl0 as $m4ac_ixteyr6q) { $m4ac_vj7al2oxz = $m4ac_ixteyr6q->getPathname(); if (! stripos($m4ac_vj7al2oxz, '.git')) { if (! is_writeable($m4ac_vj7al2oxz)) { $m4ac_rf3lt2m8kg_ = false; break; } } } if (! $m4ac_rf3lt2m8kg_) { $m4ac_fic2e07vfkz = [ 'label' => 'Memberium Plugin Folder is not Writeable', 'status' => 'recommended', 'badge' => [ 'label' => __('Updates'), 'color' => 'orange', ], 'description' => '<p>One or more files in your Memberium plugin folder are not writeable.</p><p>This may prevent updates or debugging builds from working.</p>', 'actions' => '<p>Reset the permissions on the Memberium plugin folder to be writeable.</p>', 'test' => 'm4ac_hfk_ab8zgc3', ]; } return $m4ac_fic2e07vfkz; } static 
function m4ac_u5kx1jdpb() : array { $m4ac_kmq95a1exf2 = isset($_SERVER['SERVER_SOFTWARE']) ? $_SERVER['SERVER_SOFTWARE'] : ''; $m4ac_fic2e07vfkz = []; if (stripos($m4ac_kmq95a1exf2, 'flywheel') !== false) { $m4ac_fic2e07vfkz = [ 'label' => 'FlyWheel Hosting detected', 'status' => 'critical', 'badge' => [ 'label' => __('Performance'), 'color' => 'orange' ], 'description' => 'FlyWheel hosting was detected.  Fly/Wheel uses aggressive caching which may display private member info to other members, break autologins, and other problems.  Turning on Dev Mode will often fix these issues.', 'actions' => '', 'test' => 'wpal_healthcheck_flywheel', ]; } return $m4ac_fic2e07vfkz; } static 
function m4ac_g5qfku72d0b() : array { $m4ac_f92tkhgnzfcb = []; $m4ac_tp09y21w7hcn = false; $m4ac_np_x9yaz0 = defined('GD_PLAN_NAME') ? strtolower(GD_PLAN_NAME) : ''; if (strpos($m4ac_np_x9yaz0, 'managed wordpress') !== false) { $m4ac_f92tkhgnzfcb = [ 'label' => 'GoDaddy Managed WordPress Hosting', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red' ], 'description' => '<p>GoDaddy Managed WordPress hosting was detected.   GoDaddy Managed WordPress is incompatible with Memberium and is not a supported hosting plan.  This will cause Memberium to not work properly.</p>', 'actions' => '<p>We recommend switching to another hosting provider, or to GoDaddy cPanel Linux hosting.</p>', 'test' => 'wpal_hosting_godaddy_managed', ]; } return $m4ac_f92tkhgnzfcb; } static 
function m4ac_tt7oha693ic() : array {  $m4ac_fic2e07vfkz = [ 'label' => 'Can Communicate with Memberium License Server', 'status' => 'good', 'badge' => [ 'label' => __( 'Memberium' ), 'color' => 'green'], 'description' => 'Your connection to the license server appears to be working properly.', 'actions' => '', 'test' => 'wpal_healthcheck_hostblocking', ]; if (defined('WP_HTTP_BLOCK_EXTERNAL') && constant('WP_HTTP_BLOCK_EXTERNAL') == 1) { $m4ac_z0y2zjw14p = defined('WP_ACCESSIBLE_HOSTS') ? strtolower(constant('WP_ACCESSIBLE_HOSTS') ) : ''; $m4ac_hicam8byku = array_filter(explode(',', $m4ac_z0y2zjw14p) ); $m4ac_hicam8byku = array_filter($m4ac_hicam8byku); $m4ac_h57xqitcp = memberium_app()->m4ac_bztk3xj1(); $m4ac_iwnxpevu = [ 'licenseserver.webpowerandlight.com', 'licenseserver.memberium.com', ]; foreach($m4ac_iwnxpevu as $k => $m4ac_y2mw1xc6rq) { if (in_array($m4ac_y2mw1xc6rq, $m4ac_hicam8byku) ) { unset($m4ac_iwnxpevu[$k]); } } if (! empty($m4ac_iwnxpevu) ) { $m4ac_ygjqnpcx = trim($m4ac_z0y2zjw14p . "," . implode(',', $m4ac_iwnxpevu), ','); $m4ac_eohq7wvlb0i = 'notice notice-error'; $m4ac_oemjasi0tp = '<h3>External Hosts Blocked</h3>' . '<p>Memberium has detected that you are blocking access to external hosts, through your wp-config.php file.' . 'You will either need to remove the <strong>WP_HTTP_BLOCK_EXTERNAL</strong> setting, or add our hosts to the <strong>WP_ACCESSIBLE_HOSTS</strong> setting.' . 'Leaving this problem unaddressed will cause your plugin to stop working.</p>' . "<p style='font-family:\"courier new\",monospace;font-size:120%;'>define('WP_ACCESSIBLE_HOSTS', '" . $m4ac_ygjqnpcx . "');</p>" . '<p>If you would like assistance, please contact <a target="_blank" href="https://memberium.com/support/">Memberium Support.</a></p>'; $m4ac_fic2e07vfkz['label'] = 'Memberium License Server is blocked'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] = $m4ac_oemjasi0tp; } } return $m4ac_fic2e07vfkz; } static 
function m4ac_qay2dsfoj() : array {   $m4ac_s2abgdqi4w0_ = get_option('active_plugins'); $m4ac_zdir9610 = get_plugins(); $m4ac_fic2e07vfkz = []; $m4ac_jvm76ow2i8lc = []; $m4ac_xeslz6uj4 = []; $m4ac_hakbo4tlcx2_ = get_admin_url(null, 'plugins.php?s=memberium install&plugin_status=all'); $m4ac_fic2e07vfkz = [ 'label' => 'Remove Memberium Installer Plugin', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_memberium_installer', ]; foreach($m4ac_zdir9610 as $m4ac_b54e9qp61xcg => $m4ac_c1m92xtgl8z) { if (stripos($m4ac_b54e9qp61xcg, 'memberium') !== false && (stripos($m4ac_b54e9qp61xcg, 'install') !== false || stripos($m4ac_b54e9qp61xcg, 'wizard') !== false) ) { $m4ac_jvm76ow2i8lc[] = $m4ac_b54e9qp61xcg; $m4ac_fic2e07vfkz['status'] = 'recommended'; $m4ac_fic2e07vfkz['badge']['color'] = 'orange'; } } foreach($m4ac_s2abgdqi4w0_ as $m4ac_b54e9qp61xcg) { if (stripos($m4ac_b54e9qp61xcg, 'memberium') !== false && (stripos($m4ac_b54e9qp61xcg, 'install') !== false || stripos($m4ac_b54e9qp61xcg, 'wizard') !== false) ) { $m4ac_jvm76ow2i8lc[] = $m4ac_b54e9qp61xcg; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; } } if (! empty($m4ac_jvm76ow2i8lc)) { foreach($m4ac_jvm76ow2i8lc as $m4ac_b54e9qp61xcg) { if (isset($m4ac_zdir9610[$m4ac_b54e9qp61xcg])) { $m4ac_xeslz6uj4[] = "<em>{$m4ac_zdir9610[$m4ac_b54e9qp61xcg]['Name']}</em> by {$m4ac_zdir9610[$m4ac_b54e9qp61xcg]['Author']}"; } } } if (! empty($m4ac_xeslz6uj4)) { $m4ac_fic2e07vfkz['description'] = '<p>The Memberium installation wizard plugin was found in your system.  This plugin is no longer needed once Memberium is installed, and will only slow down your system.</p>'; $m4ac_fic2e07vfkz['actions'] = '<p>We recommend <a href="' . $m4ac_hakbo4tlcx2_ . '">deactivating and removing</a> the following plugins:</p>'; foreach($m4ac_xeslz6uj4 as $m4ac_b54e9qp61xcg) { $m4ac_fic2e07vfkz['actions'] .= "<p>{$m4ac_b54e9qp61xcg}</p>"; } } if ($m4ac_fic2e07vfkz['status'] !== 'good') { return $m4ac_fic2e07vfkz; } return []; } static 
function m4ac_c63nfd9u4hba() : array { $m4ac_fic2e07vfkz = []; if (memberium_app()->m4ac_lxda3js50urg() === 'production') { $m4ac_ynwuq9s04 = false; $m4ac_d78sk4qc3i = strtolower(trim(get_bloginfo('admin_email') ) ); $m4ac_wd6_245o = [ '.secureserver.net', '.sg-host.com', '.wpengine.com', 'liquidwebsites.com', '@cloudways', '@example', '@flywheel.local', '@localhost', '@entre.cloud', '@admin.com', '@admin.com', ]; if (empty($m4ac_d78sk4qc3i) ) { $m4ac_ynwuq9s04 = true; } foreach($m4ac_wd6_245o as $m4ac_jbqpi7nfo48) { if (stripos($m4ac_d78sk4qc3i, $m4ac_jbqpi7nfo48) !== false) { $m4ac_ynwuq9s04 = true; break; } } if ($m4ac_ynwuq9s04) { $m4ac_fvlat1o_7gjr = '<a href="' . get_admin_url(null, 'options-general.php') . '"> target="_blank">here</a>'; $m4ac_d78sk4qc3i = esc_html($m4ac_d78sk4qc3i); $m4ac_fic2e07vfkz = [ 'label' => 'Invalid Site Administrator Contact Email', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>An invalid email ({$m4ac_d78sk4qc3i}) was detected in the site's <strong>Administration Email Address</strong> setting.  This may affect your software license management.</p>", 'actions' => '<p>We recommend setting your Administrator email address to a valid email.  You can update this setting ' . $m4ac_fvlat1o_7gjr . '</p>', 'test' => 'wpal_wordpress_administrator_email', ]; } } return $m4ac_fic2e07vfkz; } static 
function m4ac_u_v13k0irzw() : array { $m4ac_fic2e07vfkz = []; $m4ac_td_ae28tyfz = [  'administrator', 'memberium', 'sitemanager', 'support', 'test', ]; foreach ($m4ac_td_ae28tyfz as $m4ac_y6n73tb0c5) { $m4ac_fheyfujga6 = get_user_by('login', $m4ac_y6n73tb0c5); if ($m4ac_fheyfujga6 && memberium_app()->m4ac_k6b8c0f7g5($m4ac_fheyfujga6->ID) ) { break; } $m4ac_fheyfujga6 = false; } if ($m4ac_fheyfujga6 && is_a($m4ac_fheyfujga6, 'WP_User') ) { $m4ac_y6n73tb0c5 = $m4ac_fheyfujga6->user_login; $m4ac_tvdljq4ki0 = '<a href="' . get_admin_url(null, "user-edit.php?user_id={$m4ac_fheyfujga6->ID}") . '">view the user here</a>'; $m4ac_fic2e07vfkz = [ 'label' => 'Default Admin Account Logins', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'orange', ], 'description' => "<p>Your install of Memberium has one or more admin user using the default admin name of '{$m4ac_y6n73tb0c5}'.  This increases the exposure of your site to attack by hackers bruteforcing your admin login.</p>", 'actions' => '<p>You can ' . $m4ac_tvdljq4ki0 . '. We recommend changing your WordPress admin username to something non-obvious.</p><p>If you have questions, please ' . self::$m4ac_n2kqiyparg5 . '</p>', 'test' => 'wpal_wordpress_admin_is_admin', ]; } return $m4ac_fic2e07vfkz; } static 
function m4ac_a80ixndszba() : array { $m4ac_fic2e07vfkz = []; $m4ac_l2iawx3s9zou = memberium_app()->m4ac_lx4jv6fi7k(); $m4ac_e2mdjhsc7v = m4ac_yyac92bkugv1::m4ac_jp13clzd(); $m4ac_fvlat1o_7gjr = get_admin_url(null, 'admin.php?page=memberium-support&tab=updates'); $m4ac_fic2e07vfkz = [ 'label' => 'Memberium Plugin Version', 'status' => 'good', 'badge' => [ 'label' => __('Performance'), 'color' => 'green', ], 'description' => "<p>Your install of Memberium is running the latest available version.</p>", 'actions' => '', 'test' => 'wpal_memberium_outdated', ]; if (version_compare($m4ac_e2mdjhsc7v, $m4ac_l2iawx3s9zou, '>') ) { $m4ac_fic2e07vfkz['label'] = 'Memberium Plugin Requires Update'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] = "<p>Your install of Memberium is running an older version (v{$m4ac_l2iawx3s9zou}).  Your version is missing features, performance, and security improvements.   Only current versions are eligible for some kinds of support.</p>"; $m4ac_fic2e07vfkz['actions'] = "<p>We recommend <a href='{$m4ac_fvlat1o_7gjr}'>updating to the latest version</a> v{$m4ac_e2mdjhsc7v}.</p><p>If you would like assistance, please contact <a href='https://memberium.com/support/' target='_blank'>Memberium Support</a>.</p>"; } return $m4ac_fic2e07vfkz; } static 
function m4ac_n1nzup7e8i5() : array { $m4ac_fic2e07vfkz = []; $m4ac_td_ae28tyfz = [ 'support@memberium.com', 'support@memberium.zendesk.com', ]; foreach ($m4ac_td_ae28tyfz as $m4ac_y6n73tb0c5) { $m4ac_fheyfujga6 = get_user_by('email', $m4ac_y6n73tb0c5); if ($m4ac_fheyfujga6 && memberium_app()->m4ac_k6b8c0f7g5($m4ac_fheyfujga6->ID) ) { break; } $m4ac_fheyfujga6 = false; } if ($m4ac_fheyfujga6) { $m4ac_y6n73tb0c5 = $m4ac_fheyfujga6->user_login; $m4ac_tvdljq4ki0 = '<a href="' . get_admin_url(null, "user-edit.php?user_id={$m4ac_fheyfujga6->ID}") . '">view the user here</a>'; $m4ac_fic2e07vfkz = [ 'label' => 'Memberium Support Admins', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'orange', ], 'description' => "<p>Your install of Memberium has one or more admin users belonging to Memberium support.</p>", 'actions' => "<p>We recommend changing the user's role to 'Subscriber', or deleting the user completely once the login is no longer needed.</p><p>If you have questions, please " . self::$m4ac_n2kqiyparg5 . "</p><p>You can {$m4ac_tvdljq4ki0}.</p>", 'test' => 'wpal_memberium_support_account', ]; } return $m4ac_fic2e07vfkz; } static 
function m4ac_dau279chx_b() : array { if (! function_exists('get_plugins') ) { require_once ABSPATH . 'wp-admin/includes/plugin.php'; } $m4ac_fic2e07vfkz = []; $m4ac_xeslz6uj4 = array_merge(get_plugins(), get_mu_plugins() ); $m4ac_gcri_3ek = []; $m4ac_mv12qfd0jxr = [ 'infusion4wp/infusion4wpload.php', 'memberful-wp/memberful-wp.php', 'members/members.php', 'paid-member-subscriptions/index.php', 'paid-memberships-pro/paid-memberships-pro.php', 'restrict-content/restrictcontent.php', 's2member/s2member.php', 'simple-membership-after-login-redirection/swpm-after-login-redirection.php', 'simple-membership/simple-wp-membership.php', 'wishlist-member/wpm.php', 'wp-members/wp-members.php', ]; foreach($m4ac_mv12qfd0jxr as $m4ac_rxqa04teu2f) { if (array_key_exists($m4ac_rxqa04teu2f, $m4ac_xeslz6uj4)) { $m4ac_b54e9qp61xcg = $m4ac_xeslz6uj4[$m4ac_rxqa04teu2f]; $m4ac_w6baucteghm = isset($m4ac_b54e9qp61xcg['Name']) ? $m4ac_b54e9qp61xcg['Name'] : $m4ac_o1uhaeys7; $m4ac_jik4jc6e = isset($m4ac_b54e9qp61xcg['Version']) ? $m4ac_b54e9qp61xcg['Version'] : ''; $m4ac_gcri_3ek[] = $m4ac_w6baucteghm . ' v' . $m4ac_jik4jc6e; } } if (! empty($m4ac_gcri_3ek)) { $m4ac_fic2e07vfkz = [ 'label' => 'Conflicting Membership Plugins Found', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>The following membership plugins were found installed on your system.  " . "Running multiple membership plugins is not supported. " . "Installation and of these plugins can cause problems including access controls being broken, data corruption, and the wrong information displayed to the wrong users.</p>", 'actions' => '<p>We recommend deactivating and removing these plugins.</p>', 'test' => 'wpal_wordpress_plugins_membership', 'data' => $m4ac_gcri_3ek, ]; foreach($m4ac_gcri_3ek as $m4ac_o9gv2ip5qe) { $m4ac_fic2e07vfkz['description'] .= $m4ac_o9gv2ip5qe . '<br />'; } } return $m4ac_fic2e07vfkz; } static 
function m4ac_f25sze6ry() : array { $m4ac_t3cu9hgt = get_option(MEMBERIUM_MEMBERSHIP_SETTINGS, []); $m4ac_g9fn685ibx = count($m4ac_t3cu9hgt); $m4ac_fic2e07vfkz = [ 'label' => 'Memberium Membership Levels', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_memberium_membership_levels', ]; if ($m4ac_g9fn685ibx == 0) { $m4ac_fic2e07vfkz['status'] = 'recommended'; $m4ac_fic2e07vfkz['badge']['color'] = 'orange'; $m4ac_fic2e07vfkz['description'] .= '<p>No Memberium membership levels were found.</p>'; $m4ac_fic2e07vfkz['actions'] .= '<p>We recommend creating one or more Memberium membership levels to properly secure your site.</p>'; } else { $m4ac_j0e14tousp_ = memberium_app()->m4ac_ni3dn9fc(false); $m4ac_ebc8ofw5rva = ['main_id', 'payf_id', 'cancel_id', 'suspend_id']; $m4ac_f8dnpolaceg5 = []; $m4ac_g27zjfc8i0 = []; foreach($m4ac_t3cu9hgt as $m4ac_qb48jahn0kc) { foreach($m4ac_ebc8ofw5rva as $m4ac_ukqvxo6ne7) { if (! empty($m4ac_qb48jahn0kc[$m4ac_ukqvxo6ne7]) ) { $m4ac_o75qrnlisk = $m4ac_qb48jahn0kc[$m4ac_ukqvxo6ne7]; $m4ac_f8dnpolaceg5[$m4ac_o75qrnlisk] = $m4ac_qb48jahn0kc['name']; } } if (! empty($m4ac_qb48jahn0kc['addltag_ids'])) { $m4ac_bj4cbs9v8w = explode(',', $m4ac_qb48jahn0kc['addltag_ids']); foreach($m4ac_bj4cbs9v8w as $m4ac_o75qrnlisk) { $m4ac_f8dnpolaceg5[$m4ac_o75qrnlisk] = $m4ac_qb48jahn0kc['name']; } } } array_unique($m4ac_f8dnpolaceg5); uasort($m4ac_f8dnpolaceg5, function($a, $b) { return (int) ($a > $b); }); foreach($m4ac_f8dnpolaceg5 as $m4ac_o75qrnlisk => $m4ac_pzocy3nw) { if (! array_key_exists($m4ac_o75qrnlisk, $m4ac_j0e14tousp_['mc'])) { $m4ac_g27zjfc8i0[$m4ac_pzocy3nw][] = $m4ac_o75qrnlisk; } } if (! empty($m4ac_g27zjfc8i0)) { $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; foreach($m4ac_g27zjfc8i0 as $m4ac_qb48jahn0kc => $m4ac_j0e14tousp_) { if (! empty($m4ac_j0e14tousp_)) { $m4ac_fic2e07vfkz['description'] .= "<p>Your {$m4ac_qb48jahn0kc} membership level is missing the following tag IDs: " . implode(',', $m4ac_j0e14tousp_) . "</p>"; } } $m4ac_fic2e07vfkz['actions'] = '<p>Check your tag sync options to ensure you are not blocking any tag categories used by your membership levels.</p>'; $m4ac_fic2e07vfkz['actions'] .= '<p>If the referenced tags no longer exist, remove them from your membership, or delete the membership level.</p>'; } } if ($m4ac_fic2e07vfkz['status'] == 'good') { $m4ac_fic2e07vfkz['description'] = "<p>Your {$m4ac_g9fn685ibx} membership levels appear to be present and properly configured.</p>"; } return $m4ac_fic2e07vfkz; } static 
function m4ac_v9ip25bry() : array { $m4ac_vc9dnsteqpb = intval(wp_convert_hr_to_bytes(WP_MEMORY_LIMIT) / 1024 / 1024); $m4ac_ugf53948nuym = intval(wp_convert_hr_to_bytes(WP_MAX_MEMORY_LIMIT) / 1024 / 1024); $m4ac_fic2e07vfkz = [ 'label' => 'Sufficient Memory Allocated', 'status' => 'good', 'badge' => [ 'label' => __('Performance'), 'color' => 'green', ], 'description' => "You have {$m4ac_vc9dnsteqpb}MB allocated to the frontend, and {$m4ac_ugf53948nuym}MB allocated to the admin dashboard.", 'actions' => '', 'test' => 'wpal_healthcheck_memory', ]; if ($m4ac_vc9dnsteqpb < 41) { $m4ac_oemjasi0tp = "<p>Your site is configured with a memory limit of {$m4ac_vc9dnsteqpb}MB<br />" . 'You can increase your WordPress memory limit by adding or updating the following line in your wp-config.php:<br />' . "<code>define('WP_MEMORY_LIMIT', '64M');</code><br />" . 'For sites with many or complex plugins or themes, you may want to set it to 96M, 128M, 160M or more.</p>'; $m4ac_fic2e07vfkz['label'] = 'Memory Warning'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] = $m4ac_oemjasi0tp; } if ($m4ac_vc9dnsteqpb > 256) { $m4ac_oemjasi0tp = "<p>Your site is configured with WP_MEMORY_LIMIT set to {$m4ac_vc9dnsteqpb}MB.<br />" . 'Sites needing high memory allocations often can cause performance issues due to misconfiguration and this is not normal even for large sites.  ' . 'We recommend contacting <a href="https:://memberium.com/support/">Memberium support</a> for assistance.</p>'; $m4ac_fic2e07vfkz['label'] = 'Memory Warning'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] = $m4ac_oemjasi0tp; } if ($m4ac_ugf53948nuym < 40) { $m4ac_oemjasi0tp = "<p>Your site is configured with an Admin memory limit of {$m4ac_ugf53948nuym}MB<br />" . 'You can increase your WordPress memory limit by adding or updating the following line in your wp-config.php:<br />' . "<code>define('WP_MAX_MEMORY_LIMIT', '64M');</code><br />" . 'For sites with many or complex plugins or themes, you may want to set it to 96M, 128M, 160M or more.</p>'; $m4ac_fic2e07vfkz['label'] = 'Memory Warning'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] .= $m4ac_oemjasi0tp; }  return $m4ac_fic2e07vfkz; } static 
function m4ac_gcik7ugrbezj() : array { global $wpdb; $m4ac_kqzvwpxl7 = get_option('memberium_tables', [] ); $m4ac_ix2ahcuv = []; $m4ac_fic2e07vfkz = [ 'label' => __('Memberium Database Tables'), 'status' => 'good', 'badge' => [ 'label' => __('Database'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_database_tables', ]; if (is_array($m4ac_kqzvwpxl7)) { foreach($m4ac_kqzvwpxl7 as $m4ac_ixesh4rzk) { $m4ac_xtcz6bi97flk = "SELECT 1 FROM `{$m4ac_ixesh4rzk}` LIMIT 1;"; $wpdb->get_var($m4ac_xtcz6bi97flk); $m4ac_vykuqfwdj_0 = $wpdb->last_error; if ($m4ac_vykuqfwdj_0) { $m4ac_ix2ahcuv[] = $m4ac_ixesh4rzk; } } sort($m4ac_ix2ahcuv); } if (! empty($m4ac_ix2ahcuv)) { $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] = '<p>The following essential database tables are missing or unreadable.</p>'; foreach($m4ac_ix2ahcuv as $m4ac_pzocy3nw) { $m4ac_fic2e07vfkz['description'] .= "{$m4ac_pzocy3nw}<br />"; } } else { $m4ac_fic2e07vfkz['description'] = '<p>All Memberium database tables are present.</p>'; } return $m4ac_fic2e07vfkz; } static 
function m4ac_vighwcoy3xa() : array { $m4ac_s2abgdqi4w0_ = get_option('active_plugins'); $m4ac_tp09y21w7hcn = false; $m4ac_fic2e07vfkz = []; foreach($m4ac_s2abgdqi4w0_ as $m4ac_b54e9qp61xcg) { if (stripos($m4ac_b54e9qp61xcg, 'menu-items-visibility-control') !== false) { $m4ac_tp09y21w7hcn = true; break; } } if ($m4ac_tp09y21w7hcn) { $m4ac_hakbo4tlcx2_ = get_admin_url(null, 'plugins.php?s=menu items visibility control&plugin_status=search'); $m4ac_fic2e07vfkz = [ 'label' => 'Deactivate Menu Items Visibility Control Plugin', 'status' => 'critical', 'badge' => [ 'label' => __('Performance'), 'color' => 'red', ], 'description' => "<p>Memberium has detected that you have the Menu Items Visibility Control plugin installed.  The function provided by this plugin has been replaced by Memberium's enhanced native Menu visibility controls with more features and better security.</p><p>Memberium has already imported the settings from this plugin.</p>", 'actions' => "<p>We recommend <a href='{$m4ac_hakbo4tlcx2_}'>deactivating</a> this plugin.</p>", 'test' => 'wpal_memberium_mivc_plugin', ]; } return $m4ac_fic2e07vfkz; } static 
function m4ac_w87aikfhctdu() : array { $m4ac_fic2e07vfkz = []; if (defined('MULTISITE') && MULTISITE) { $m4ac_fic2e07vfkz = [ 'label' => 'Memberium is not Network Activated', 'status' => 'good', 'badge' => [ 'label' => __('Performance'), 'color' => 'green', ], 'description' => '', 'actions' => '', 'test' => 'wpal_m4is_network_activation', ]; $m4ac_lroj7z109 = (array) get_site_option('active_sitewide_plugins'); $m4ac_ywrfzv_dcob = isset($m4ac_lroj7z109['memberium2/memberium2.php']) ? $m4ac_lroj7z109['memberium2/memberium2.php'] > 0 : false; if ($m4ac_ywrfzv_dcob) { $m4ac_fic2e07vfkz['label'] = 'Memberium is Network Activated'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'orange'; $m4ac_fic2e07vfkz['description'] .= '<p>It is recommended to only activate Memberium only on a per-site basis, unless ALL sites in the network are always actively being used for memberships.</pre>'; $m4ac_fic2e07vfkz['actions'] .= '<p>We recommend Network Deactivating Memberium, and activating it on any individual network sites it is actively being used on.</p>'; } } return $m4ac_fic2e07vfkz; } static 
function m4ac_xnjr075umcyl() : array { $m4ac_fic2e07vfkz = []; $m4ac_ynkmvw3f02bo = function_exists('wp_using_ext_object_cache') ? wp_using_ext_object_cache() : 'production'; $m4ac_fic2e07vfkz = [ 'label' => 'Object Caching Missing / Inactive', 'status' => 'recommended', 'badge' => [ 'label' => __('Performance'), 'color' => 'red', ], 'description' => '<p>Object caching was not detected.  Memberium is designed to use object caching to both speed up operations and reduce database loads.</p>', 'actions' => '<p>Install and activate object caching.</p>', 'test' => 'wpal_wordpress_object_cache', ]; if ($m4ac_ynkmvw3f02bo) { $m4ac_fic2e07vfkz['label'] = 'Object Caching Active'; $m4ac_fic2e07vfkz['status'] = 'good'; $m4ac_fic2e07vfkz['badge']['color'] = 'green'; $m4ac_fic2e07vfkz['description'] = '<p>Object Caching was detected.  Most Excellent!</p>'; $m4ac_fic2e07vfkz['actions'] = ''; } return $m4ac_fic2e07vfkz; } static 
function m4ac_crvfozhc() : array { $m4ac_f92tkhgnzfcb = []; $m4ac_wf_gxwueik = get_option('users_can_register', false); if ($m4ac_wf_gxwueik) { $m4ac_f92tkhgnzfcb = [ 'label' => 'Open Registration', 'status' => 'recommended', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => '<p>Your WordPress site has been configured to allow any user to register.</p>', 'actions' => '<p>It is recommended that you disable this setting, and use Keap / Infusionsoft to handle new user registrations.</p>' . '<p>You can change this setting <a href="options-general.php">here</a>, by unchecking "<strong>Anyone can register</strong>".</p>', 'test' => 'wpal_wordpress_open_registration', ]; } return $m4ac_f92tkhgnzfcb; } static 
function m4ac_riz80b7rqf() : array { $m4ac_f92tkhgnzfcb = []; if (memberium_app()->m4ac_lxda3js50urg() === 'production') { $m4ac_y2qgpsabwt = array_diff(scandir(ABSPATH), ['.', '..']); $m4ac_sg3szkd15ro = []; foreach($m4ac_y2qgpsabwt as $m4ac_ixteyr6q) { $m4ac_ixteyr6q = ABSPATH . $m4ac_ixteyr6q; if (! is_dir($m4ac_ixteyr6q)) { if (stripos(file_get_contents($m4ac_ixteyr6q, false, null, 0, 256), '<?') !== false) { if (stripos(file_get_contents($m4ac_ixteyr6q, false, null, 0, 256), 'phpinfo(') !== false) { $m4ac_sg3szkd15ro[] = $m4ac_ixteyr6q; } } } } if (count($m4ac_sg3szkd15ro) ) { $m4ac_f92tkhgnzfcb = [ 'label' => 'PHPinfo() Security Issue', 'status' => 'critical', 'badge' => [ 'label' => __('Security'), 'color' => 'red', ], 'description' => "<p>Files with the phpinfo() debug code have been detected in your top level WordPress directory.  These files are not used by WordPress, and they expose sensitive security information about your server and site that can be used by attackers.</p>", 'actions' => '<p>Please ask your web host to review and remove the following files:</p>', 'test' => 'wpal_server_phpinfo', ]; foreach($m4ac_sg3szkd15ro as $m4ac_ixteyr6q) { $m4ac_f92tkhgnzfcb['actions'] .= "{$m4ac_ixteyr6q}<br>"; } } } return $m4ac_f92tkhgnzfcb; } static 
function m4ac_mxa8e23ultw() : array { $m4ac_fic2e07vfkz = [ 'label' => 'No Proxies detected', 'status' => 'good', 'badge' => [ 'label' => __('Security'), 'color' => 'green' ], 'description' => 'No web proxies were detected.  Web Proxies like Cloudflare and Securi are services to secure and speed up your website, however they may interfere with HTTP POSTs coming from Infusionsoft/Keap.', 'actions' => '', 'test' => 'wpal_healthcheck_cloudflare', 'data' => false, ]; if (! empty($_SERVER['HTTP_CF_RAY']) ) { $m4ac_oemjasi0tp = '<p>Memberium has detected that you are using CloudFlare.  We recommend reviewing your CloudFlare configuration to ensure that page caching is disabled.</p>'; $m4ac_fic2e07vfkz['label'] = 'CloudFlare Detected'; $m4ac_fic2e07vfkz['status'] = 'recommended'; $m4ac_fic2e07vfkz['badge']['color'] = 'orange'; $m4ac_fic2e07vfkz['description'] = $m4ac_oemjasi0tp; $m4ac_fic2e07vfkz['data'] = 'CloudFlare'; } return $m4ac_fic2e07vfkz; } static 
function m4ac_wg3s476y() : array { $m4ac_j0e14tousp_ = memberium_app()->m4ac_ni3dn9fc(false); $m4ac_g9fn685ibx = isset($m4ac_j0e14tousp_['mc']) && is_array($m4ac_j0e14tousp_['mc']) ? count($m4ac_j0e14tousp_['mc']) : 0; $m4ac_gtagbf_iwjcv = get_option('memberium_tables_updated', [] ); $m4ac_wd7aq53u4o = empty($m4ac_gtagbf_iwjcv['tags']) ? 0 : $m4ac_gtagbf_iwjcv['tags']; $m4ac_fic2e07vfkz = [ 'actions' => '', 'description' => "<p>We found {$m4ac_g9fn685ibx} tags synced from ActiveCampaign.</p>", 'label' => 'Memberium Tags', 'status' => 'good', 'test' => 'wpal_memberium_tags', 'badge' => [ 'label' => __('CRM'), 'color' => 'green', ], ]; if ($m4ac_g9fn685ibx) { $m4ac_fvlat1o_7gjr = get_admin_url(null, 'admin.php?page=memberium-support&tab=dashboard'); $m4ac_fic2e07vfkz['actions'] = '<p>If you are missing some tags, you can <a href="' . $m4ac_fvlat1o_7gjr . '"> resynchronize the tag list here</a>:</p>'; if ($m4ac_wd7aq53u4o) { $m4ac_fic2e07vfkz['description'] .= '<p>Your tags were last synced ' . human_time_diff($m4ac_wd7aq53u4o) . ' ago.</p>'; } } else { $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] = '<p>No tags have been synced from Infusionsoft.</p>'; $m4ac_fic2e07vfkz['actions'] = ''; } return $m4ac_fic2e07vfkz; } static 
function m4ac_bl528vwrn() : array { $m4ac_en4go8fjyu = []; $m4ac_j0e14tousp_ = memberium_app()->m4ac_ni3dn9fc( false ); $m4ac_j0e14tousp_ = isset( $m4ac_j0e14tousp_['mc'] ) ? $m4ac_j0e14tousp_['mc'] : []; $m4ac_fic2e07vfkz = [ 'actions' => '', 'description' => "<p>All tags appear to be sanely named..</p>", 'label' => 'ActiveCampaign Tag Names', 'status' => 'good', 'test' => 'wpal_memberium_tag_names', 'badge' => [ 'label' => __('CRM'), 'color' => 'green', ], ]; foreach( $m4ac_j0e14tousp_ as $m4ac_o75qrnlisk ) { if ( is_numeric( $m4ac_o75qrnlisk ) ) { $m4ac_en4go8fjyu[] = $m4ac_o75qrnlisk; } } if ( count( $m4ac_j0e14tousp_ ) ) { $m4ac_l9lbyvw4xaed = '"' . implode( '", "', $m4ac_en4go8fjyu ) . '"'; $m4ac_fic2e07vfkz['status'] = 'recommended'; $m4ac_fic2e07vfkz['badge']['color'] = 'orange'; $m4ac_fic2e07vfkz['description'] = '<p>Some ActiveCampaign tags have numeric names which may create confusion when referencing them.</p>'; $m4ac_fic2e07vfkz['actions'] = "<p>We recommend renaming or deleting these tags: <em>{$m4ac_l9lbyvw4xaed}</em>.</p>"; } return $m4ac_fic2e07vfkz; }    static 
function m4ac_rieq3az8m7wo() : array { $m4ac_fic2e07vfkz = [ 'actions' => '', 'description' => '', 'label' => 'No Page Caching Plugins Found', 'status' => 'good', 'test' => 'wpal_healthcheck_caching', 'badge' => [ 'label' => __( 'Security' ), 'color' => 'green', ], ]; if (function_exists('wpsc_init')) { $m4ac_fic2e07vfkz['label'] = 'Page Caching Plugins Found'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] .= '<p>WP Super Cache is installed and active.</p>'; } if (defined('W3TC')) { $m4ac_fic2e07vfkz['label'] = 'Page Caching Plugins Found'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] .= '<p>W3 Total Cache is installed and active.</p>p>'; } if (defined('WP_ROCKET_VERSION') ) { $m4ac_fic2e07vfkz['label'] = 'Page Caching Plugins Found'; $m4ac_fic2e07vfkz['status'] = 'critical'; $m4ac_fic2e07vfkz['badge']['color'] = 'red'; $m4ac_fic2e07vfkz['description'] .= '<p>WP Rocket is installed and active.</p>'; } if (empty($m4ac_fic2e07vfkz['description'])) { $m4ac_fic2e07vfkz['description'] = '<p>No caching plugin conflicts detected.<br />Installing Caching plugins can cause data corruption and security issues.</p>'; } else { $m4ac_fic2e07vfkz['description'] .= '<p>Running caching plugins with your membership site can cause corruption and security problems.  To fix this problem, disable your caching plugins.</p>'; } return $m4ac_fic2e07vfkz; }         } }
