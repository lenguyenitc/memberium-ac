<?php
/**
 * Copyright (c) 2012-2021 David J Bullock
 * Web Power and Light
 */

 if ( class_exists('m4ac_c6rqypiacz4') ) { final 
class m4ac_sm063wn5bqyz { static 
function m4ac_d2t47rpwu9($m4ac_c1m92xtgl8z, $m4ac_c4qc56391fd = null, $m4ac_kp6zrjntmf78 = '') { if (! m4ac_tl5skz6cfptr::m4ac_e28auldn() ) { return; } if (is_feed() ) { return; } m4ac_mym496l81v::m4ac_e0yeql2bpv(); $m4ac_wdl2r3x6jg = [ 'count' => 10, 'id' => '', 'offset' => 0, 'order_by' => 'display_name', 'order_by' => 'memb_%EMAIL%', 'order' => 'ASC', 'roles' => 'subscriber', 'tag_id' => '', ]; if (isset($m4ac_c1m92xtgl8z[0]) && $m4ac_c1m92xtgl8z[0] == 'showatts') { return implode(',', array_keys($m4ac_wdl2r3x6jg) ); } $m4ac_c1m92xtgl8z = shortcode_atts($m4ac_wdl2r3x6jg, $m4ac_c1m92xtgl8z, 'memberium'); $m4ac_pa2k7635qor = ''; $m4ac_c1m92xtgl8z['order'] = strtoupper( trim($m4ac_c1m92xtgl8z['order']) ); $m4ac_c1m92xtgl8z['order_by'] = strtolower( trim($m4ac_c1m92xtgl8z['order_by']) ); $m4ac_c1m92xtgl8z['roles'] = trim( $m4ac_c1m92xtgl8z['roles'] ); $m4ac_j0e14tousp_ = trim($m4ac_c1m92xtgl8z['tag_id']); if (! empty($m4ac_c1m92xtgl8z['roles']) ) { $m4ac_c1m92xtgl8z['roles'] = explode(',', $m4ac_c1m92xtgl8z['roles']); $m4ac_c1m92xtgl8z['roles'] = array_map('trim', $m4ac_c1m92xtgl8z['roles']); $m4ac_c1m92xtgl8z['roles'] = array_map('strtolower', $m4ac_c1m92xtgl8z['roles']); $m4ac_c1m92xtgl8z['roles'] = array_filter($m4ac_c1m92xtgl8z['roles']); } else { $m4ac_c1m92xtgl8z['roles'] = []; } if (! empty($m4ac_j0e14tousp_) ) { $m4ac_j0e14tousp_ = explode(',', $m4ac_j0e14tousp_); $m4ac_j0e14tousp_ = array_map('trim', $m4ac_j0e14tousp_); $m4ac_j0e14tousp_ = array_map('strtolower', $m4ac_j0e14tousp_); $m4ac_j0e14tousp_ = array_filter($m4ac_j0e14tousp_); $m4ac_fp_uibclgk5 = implode('|', $m4ac_j0e14tousp_); } else { $m4ac_fp_uibclgk5 = ''; }  $m4ac_y71vim3b0 = [ [ [ 'key' => 'memb_tag_ids', 'compare' => 'REGEXP',  'value' => "([[:<:]]|^){$m4ac_fp_uibclgk5}([[:>:]]|$)", ], ], ]; if (! empty($m4ac_c1m92xtgl8z['id'])) { $m4ac_y71vim3b0[] = [ 'key' => 'memberium_ac_contact_id', 'compare' => '=', 'value' => empty($m4ac_c1m92xtgl8z['id']) ? 0 : $m4ac_c1m92xtgl8z['id'], ]; } else { $m4ac_y71vim3b0[] = [ 'key' => 'memberium_ac_contact_id', 'compare' => '>', 'value' => 0, ]; } $m4ac_ah90o86m = [ 'fields' => 'all', 'meta_key' => $m4ac_c1m92xtgl8z['order_by'], 'meta_query' => $m4ac_y71vim3b0, 'order' => $m4ac_c1m92xtgl8z['order'], 'orderby' => 'meta_value', 'orderby' => $m4ac_c1m92xtgl8z['order_by'], 'roles__in' => $m4ac_c1m92xtgl8z['roles'], 'number' => (int) $m4ac_c1m92xtgl8z['count'], 'offset' => (int) $m4ac_c1m92xtgl8z['offset'],  ]; if (! empty($m4ac_c1m92xtgl8z['roles']) ) { $m4ac_ah90o86m['role__in'] = $m4ac_c1m92xtgl8z['roles']; } $m4ac_gfib2lmy = get_users($m4ac_ah90o86m); $m4ac_mfg9hybj8id = count($m4ac_gfib2lmy); foreach($m4ac_gfib2lmy as $m4ac_lj_fwoc5ub1y => $m4ac_fheyfujga6) { $m4ac_at_5xofh = $m4ac_fheyfujga6->data->ID; $m4ac_uo08x_g7 = $m4ac_fheyfujga6->memberium_ac_contact_id; $m4ac_gfib2lmy[$m4ac_lj_fwoc5ub1y]->contact_fields = memberium_app()->m4ac_zrj6g8l4ap9i($m4ac_uo08x_g7, true); } $m4ac_e4adp3f6 = false !== stripos($m4ac_c4qc56391fd, '%%contact.'); $m4ac_tdow4_ys5t = false !== stripos($m4ac_c4qc56391fd, '%%role.'); $m4ac_atbo1j54aifs = false !== stripos($m4ac_c4qc56391fd, '%%user.'); $m4ac_bb2d5ix07o = false !== stripos($m4ac_c4qc56391fd, '%%meta.'); $m4ac_fp4fj7t8ih1d = false !== stripos($m4ac_c4qc56391fd, '%%capability.'); $m4ac_ftj49ng07a = [ 'ID', 'user_nicename', 'user_url', 'user_registered', 'user_status', 'display_name' ]; if (isset($m4ac_gfib2lmy[0]->data->contact_fields[$m4ac_c1m92xtgl8z['order_by']]) ) { usort($m4ac_gfib2lmy, function($u1, $u2) use ($m4ac_c1m92xtgl8z) { $v1 = $u1->data->contact_fields[$m4ac_c1m92xtgl8z['order_by']]; $v2 = $u2->data->contact_fields[$m4ac_c1m92xtgl8z['order_by']]; return ($m4ac_c1m92xtgl8z['order'] == 'ASC') ? strnatcasecmp($v1, $v2) : strnatcasecmp($v2, $v1); }); } if ( is_array($m4ac_gfib2lmy) ) { $m4ac_us5k0l_jb = 0; foreach($m4ac_gfib2lmy as $m4ac_fheyfujga6) { $m4ac_yebad2t8wi_ = $m4ac_c4qc56391fd; $m4ac_uo08x_g7 = $m4ac_fheyfujga6->memberium_ac_contact_id; $m4ac_qsvd0m6oq = memberium_app()->m4ac_zrj6g8l4ap9i($m4ac_uo08x_g7); if (is_array($m4ac_qsvd0m6oq) && ! empty($m4ac_qsvd0m6oq['%EMAIL%']) ) { $m4ac_us5k0l_jb++; $m4ac_yebad2t8wi_ = str_ireplace('%%contact.id%%', $m4ac_uo08x_g7, $m4ac_yebad2t8wi_); if ($m4ac_e4adp3f6) { foreach($m4ac_qsvd0m6oq as $m4ac_ukqvxo6ne7 => $m4ac_ihnr7cyv) { $m4ac_ukqvxo6ne7 = trim($m4ac_ukqvxo6ne7, '%'); $m4ac_yebad2t8wi_ = str_ireplace('%%contact.' . $m4ac_ukqvxo6ne7 . '%%', $m4ac_ihnr7cyv, $m4ac_yebad2t8wi_); } } if ($m4ac_tdow4_ys5t) { foreach($m4ac_fheyfujga6->roles as $m4ac_ukqvxo6ne7 => $m4ac_ihnr7cyv) { $m4ac_yebad2t8wi_ = str_ireplace('%%role.' . $m4ac_ukqvxo6ne7 . '%%', $m4ac_ihnr7cyv, $m4ac_yebad2t8wi_); } } if ($m4ac_bb2d5ix07o) { $m4ac_yebad2t8wi_ = str_ireplace('%%meta.ipaddress%%', $m4ac_fheyfujga6->login_ip_address, $m4ac_yebad2t8wi_); $m4ac_yebad2t8wi_ = str_ireplace('%%meta.login_count%%', (int) $m4ac_fheyfujga6->login_count, $m4ac_yebad2t8wi_); } if ($m4ac_atbo1j54aifs) { foreach($m4ac_ftj49ng07a as $m4ac_ukqvxo6ne7) { $m4ac_yebad2t8wi_ = str_ireplace('%%user.' . $m4ac_ukqvxo6ne7 . '%%', $m4ac_fheyfujga6->data->$m4ac_ukqvxo6ne7, $m4ac_yebad2t8wi_); } } $m4ac_pa2k7635qor = preg_replace('/(%%\S+%%)/', '', $m4ac_pa2k7635qor); $m4ac_pa2k7635qor .= $m4ac_yebad2t8wi_; } } } $m4ac_pa2k7635qor = do_shortcode($m4ac_pa2k7635qor); return $m4ac_pa2k7635qor; } } }
